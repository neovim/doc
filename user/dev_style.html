  <!DOCTYPE html>
  <html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Neovim user documentation">

    <!-- algolia docsearch https://docsearch.algolia.com/docs/docsearch-v3/ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />
    <link rel="preconnect" href="https://X185E15FPG-dsn.algolia.net" crossorigin />

    <link href="/css/normalize.min.css" rel="stylesheet">
    <link href="/css/bootstrap.css" rel="stylesheet">
    <link href="/css/main.css" rel="stylesheet">
    <link href="help.css" rel="stylesheet">
    <link href="/highlight/styles/neovim.min.css" rel="stylesheet">

    <script src="/highlight/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <title> Dev_style - Neovim docs</title>
  </head>
  <body>
    <header class="container">
    <nav class="navbar navbar-expand-lg">
      <div class="container-fluid">
        <a href="/" class="navbar-brand" aria-label="logo">
          <!--TODO: use <img src="â€¦.svg"> here instead. Need one that has green lettering instead of gray. -->
              <svg xmlns="http://www.w3.org/2000/svg" role="img" width="173" height="50" viewBox="0 0 742 214" aria-label="Neovim">
      <title>Neovim</title>
      <defs>
        <linearGradient x1="50%" y1="0%" x2="50%" y2="100%" id="a">
          <stop stop-color="#16B0ED" stop-opacity=".8" offset="0%" />
          <stop stop-color="#0F59B2" stop-opacity=".837" offset="100%" />
        </linearGradient>
        <linearGradient x1="50%" y1="0%" x2="50%" y2="100%" id="b">
          <stop stop-color="#7DB643" offset="0%" />
          <stop stop-color="#367533" offset="100%" />
        </linearGradient>
        <linearGradient x1="50%" y1="0%" x2="50%" y2="100%" id="c">
          <stop stop-color="#88C649" stop-opacity=".8" offset="0%" />
          <stop stop-color="#439240" stop-opacity=".84" offset="100%" />
        </linearGradient>
      </defs>
      <g fill="none" fill-rule="evenodd">
        <path
          d="M.027 45.459L45.224-.173v212.171L.027 166.894V45.459z"
          fill="url(#a)"
          transform="translate(1 1)"
        />
        <path
          d="M129.337 45.89L175.152-.149l-.928 212.146-45.197-45.104.31-121.005z"
          fill="url(#b)"
          transform="matrix(-1 0 0 1 305 1)"
        />
        <path
          d="M45.194-.137L162.7 179.173l-32.882 32.881L12.25 33.141 45.194-.137z"
          fill="url(#c)"
          transform="translate(1 1)"
        />
        <path
          d="M46.234 84.032l-.063 7.063-36.28-53.563 3.36-3.422 32.983 49.922z"
          fill-opacity=".13"
          fill="#000"
        />
        <g fill="#444">
          <path
            d="M227 154V64.44h4.655c1.55 0 2.445.75 2.685 2.25l.806 13.502c4.058-5.16 8.786-9.316 14.188-12.466 5.4-3.15 11.413-4.726 18.037-4.726 4.893 0 9.205.781 12.935 2.34 3.729 1.561 6.817 3.811 9.264 6.751 2.448 2.942 4.297 6.48 5.55 10.621 1.253 4.14 1.88 8.821 1.88 14.042V154h-8.504V96.754c0-8.402-1.91-14.987-5.729-19.757-3.82-4.771-9.667-7.156-17.544-7.156-5.851 0-11.28 1.516-16.292 4.545-5.013 3.032-9.489 7.187-13.427 12.467V154H227zM350.624 63c5.066 0 9.755.868 14.069 2.605 4.312 1.738 8.052 4.268 11.219 7.592s5.638 7.412 7.419 12.264C385.11 90.313 386 95.883 386 102.17c0 1.318-.195 2.216-.588 2.696-.393.48-1.01.719-1.851.719h-64.966v1.70c0 6.708.784 12.609 2.353 17.7 1.567 5.09 3.8 9.357 6.695 12.802 2.895 3.445 6.393 6.034 10.495 7.771 4.1 1.738 8.686 2.606 13.752 2.606 4.524 0 8.446-.494 11.762-1.483 3.317-.988 6.108-2.097 8.37-3.324 2.261-1.227 4.056-2.336 5.383-3.324 1.326-.988 2.292-1.482 2.895-1.482.784 0 1.388.3 1.81.898l2.352 2.875c-1.448 1.797-3.362 3.475-5.745 5.031-2.383 1.558-5.038 2.891-7.962 3.998-2.926 1.109-6.062 1.991-9.41 2.65a52.21 52.21 0 01-10.088.989c-6.152 0-11.762-1.064-16.828-3.19-5.067-2.125-9.415-5.225-13.043-9.298-3.63-4.074-6.435-9.06-8.415-14.96C310.99 121.655 310 114.9 310 107.294c0-6.408.92-12.323 2.76-17.744 1.84-5.421 4.493-10.093 7.961-14.016 3.467-3.922 7.72-6.991 12.758-9.209C338.513 64.11 344.229 63 350.624 63zm.573 6c-4.696 0-8.904.702-12.623 2.105-3.721 1.404-6.936 3.421-9.65 6.053-2.713 2.631-4.908 5.79-6.586 9.474S319.55 94.439 319 99h60c0-4.679-.672-8.874-2.013-12.588-1.343-3.712-3.232-6.856-5.67-9.43-2.44-2.571-5.367-4.545-8.782-5.92-3.413-1.374-7.192-2.062-11.338-2.062zM435.546 63c6.526 0 12.368 1.093 17.524 3.28 5.154 2.186 9.5 5.286 13.04 9.298 3.538 4.013 6.238 8.85 8.099 14.51 1.861 5.66 2.791 11.994 2.791 19.002 0 7.008-.932 13.327-2.791 18.957-1.861 5.631-4.561 10.452-8.099 14.465-3.54 4.012-7.886 7.097-13.04 9.254-5.156 2.156-10.998 3.234-17.524 3.234-6.529 0-12.369-1.078-17.525-3.234-5.155-2.157-9.517-5.242-13.085-9.254-3.57-4.013-6.285-8.836-8.145-14.465-1.861-5.63-2.791-11.95-2.791-18.957 0-7.008.93-13.342 2.791-19.002 1.861-5.66 4.576-10.496 8.145-14.51 3.568-4.012 7.93-7.112 13.085-9.299C423.177 64.094 429.017 63 435.546 63zm-.501 86c5.341 0 10.006-.918 13.997-2.757 3.99-1.838 7.32-4.474 9.992-7.909 2.67-3.435 4.664-7.576 5.986-12.428 1.317-4.85 1.98-10.288 1.98-16.316 0-5.965-.66-11.389-1.98-16.27-1.322-4.88-3.316-9.053-5.986-12.519-2.67-3.463-6-6.13-9.992-7.999-3.991-1.867-8.657-2.802-13.997-2.802s-10.008.935-13.997 2.802c-3.991 1.87-7.322 4.536-9.992 8-2.671 3.465-4.68 7.637-6.03 12.518-1.35 4.881-2.026 10.305-2.026 16.27 0 6.026.675 11.465 2.025 16.316 1.35 4.852 3.36 8.993 6.031 12.428 2.67 3.435 6 6.07 9.992 7.91 3.99 1.838 8.656 2.756 13.997 2.756z"
            fill="currentColor"
          />
          <path
            d="M530.57 152h-20.05L474 60h18.35c1.61 0 2.967.39 4.072 1.166 1.103.778 1.865 1.763 2.283 2.959l17.722 49.138a92.762 92.762 0 012.551 8.429c.686 2.751 1.298 5.5 1.835 8.25.537-2.75 1.148-5.499 1.835-8.25a77.713 77.713 0 012.64-8.429l18.171-49.138c.417-1.196 1.164-2.181 2.238-2.96 1.074-.776 2.356-1.165 3.849-1.165H567l-36.43 92zM572 61h23v92h-23zM610 153V60.443h13.624c2.887 0 4.78 1.354 5.682 4.06l1.443 6.856a52.7 52.7 0 015.097-4.962 32.732 32.732 0 015.683-3.879 30.731 30.731 0 016.496-2.57c2.314-.632 4.855-.948 7.624-.948 5.832 0 10.63 1.579 14.39 4.736 3.758 3.157 6.57 7.352 8.434 12.585 1.444-3.068 3.248-5.698 5.413-7.894 2.165-2.194 4.541-3.984 7.127-5.367a32.848 32.848 0 018.254-3.068 39.597 39.597 0 018.796-.992c5.111 0 9.653.783 13.622 2.345 3.97 1.565 7.307 3.849 10.014 6.857 2.706 3.007 4.766 6.675 6.18 11.005C739.29 83.537 740 88.5 740 94.092V153h-22.284V94.092c0-5.894-1.294-10.329-3.878-13.306-2.587-2.977-6.376-4.465-11.368-4.465-2.286 0-4.404.391-6.358 1.172a15.189 15.189 0 00-5.144 3.383c-1.473 1.474-2.631 3.324-3.474 5.548-.842 2.225-1.263 4.781-1.263 7.668V153h-22.37V94.092c0-6.194-1.249-10.704-3.744-13.532-2.497-2.825-6.18-4.24-11.051-4.24-3.19 0-6.18.798-8.976 2.391-2.799 1.593-5.399 3.775-7.804 6.54V153H610zM572 30h23v19h-23z"
            fill="currentColor"
            fill-opacity=".8"
          />
        </g>
      </g>
    </svg>
  
          <!--<img src="https://neovim.io/logos/neovim-logo.svg" width="173" height="50" alt="Neovim" />-->
        </a>
        <div id="docsearch"></div> <!-- algolia docsearch https://docsearch.algolia.com/docs/docsearch-v3/ -->
      </div>
    </nav>
  </header>

  <div class="container golden-grid help-body">
  <div class="col-wide">
  <a name="dev-style"></a><h1 id="dev_style.txt"> Dev_style</h1>
  <p>
    <i>
    Nvim <code>:help</code> pages, <a href="https://github.com/neovim/neovim/blob/master/scripts/gen_help_html.lua">generated</a>
    from <a href="https://github.com/neovim/neovim/blob/master/runtime/doc/dev_style.txt">source</a>
    using the <a href="https://github.com/neovim/tree-sitter-vimdoc">tree-sitter-vimdoc</a> parser.
    </i>
  </p>
  <hr/>
  <div class="old-help-para">Nvim style guide</div>
<div class="old-help-para">This is style guide for developers working on Nvim's source code.</div>
<div class="old-help-para">License: CC-By 3.0 <a href="https://creativecommons.org/licenses/by/3.0/">https://creativecommons.org/licenses/by/3.0/</a></div>
<div class="old-help-para"><h2 id="_-background" class="help-heading">Background</h2></div>
<div class="old-help-para">One way in which we keep the code base manageable is by enforcing consistency.
It is very important that any programmer be able to look at another's code and
quickly understand it.</div>
<div class="old-help-para">Maintaining a uniform style and following conventions means that we can more
easily use "pattern-matching" to infer what various symbols are and what
invariants are true about them. Creating common, required idioms and patterns
makes code much easier to understand.</div>
<div class="old-help-para">In some cases there might be good arguments for changing certain style rules,
but we nonetheless keep things as they are in order to preserve consistency.</div>
<div class="old-help-para"><h2 id="dev-style-header" class="help-heading">Header Files<span class="help-heading-tags">                                            <span class="help-tag"><a href="#dev-style-header">dev-style-header</a></span></h2></div>
<div class="old-help-para"><div class="help-column_heading">Header guard</div></div>
<div class="old-help-para">All header files should start with <code>#pragma once</code> to prevent multiple inclusion.</div>
<div class="old-help-para">    In foo/bar.h:
<pre><code class="language-c">#pragma once</code></pre></div>
<div class="old-help-para"><div class="help-column_heading">Headers system</div></div>
<div class="old-help-para">Nvim uses two types of headers. There are "normal" headers and "defs" headers.
Typically, each normal header will have a corresponding defs header, e.g.
<code>fileio.h</code> and <code>fileio_defs.h</code>. This distinction is done to minimize
recompilation on change. The reason for this is because adding a function or
modifying a function's signature happens more frequently than changing a type
The goal is to achieve the following:</div>
<div class="old-help-para"><div class="help-li" style=""> All headers (defs and normal) must include only defs headers, system
  headers, and generated declarations. In other words, headers must not
  include normal headers.
</div></div>
<div class="old-help-para"><div class="help-li" style=""> Source (.c) files may include all headers, but should only include normal
  headers if they need symbols and not types.
</div></div>
<div class="old-help-para">Use the following guideline to determine what to put where:</div>
<div class="old-help-para">Symbols:
<div class="help-li" style=""> regular function declarations
</div><div class="help-li" style=""> <code>extern</code> variables (including the <code>EXTERN</code> macro)
</div></div>
<div class="old-help-para">Non-symbols:
<div class="help-li" style=""> macros, i.e. <code>#define</code>.
</div><div class="help-li" style=""> static inline functions, but only if its function declaration has a
    <code>REAL_FATTR_ALWAYS_INLINE</code> attribute.
</div><div class="help-li" style=""> typedefs
</div><div class="help-li" style=""> structs
</div><div class="help-li" style=""> enums
</div></div>
<div class="old-help-para"><div class="help-li" style=""> All symbols must be moved to normal headers.
</div></div>
<div class="old-help-para"><div class="help-li" style=""> Non-symbols used by multiple headers should be moved to defs headers. This
  is to ensure headers only include defs headers. Conversely, non-symbols used
  by only a single header should be moved to that header.
</div></div>
<div class="old-help-para"><div class="help-li" style=""> EXCEPTION: if the macro calls a function, then it must be moved to a normal
  header.
</div></div>
<div class="old-help-para"><h2 id="dev-style-scope" class="help-heading">Scoping<span class="help-heading-tags">                                                 <span class="help-tag"><a href="#dev-style-scope">dev-style-scope</a></span></h2></div>
<div class="old-help-para"><div class="help-column_heading">Local Variables</div></div>
<div class="old-help-para">Place a function's variables in the narrowest scope possible, and initialize
variables in the declaration.</div>
<div class="old-help-para">C99 allows you to declare variables anywhere in a function. Declare them in as
local a scope as possible, and as close to the first use as possible. This
makes it easier for the reader to find the declaration and see what type the
variable is and what it was initialized to. In particular, initialization
should be used instead of declaration and assignment, e.g.<pre><code class="language-c">int i;
i = f();      // BAD: initialization separate from declaration.
int j = g();  // GOOD: declaration has initialization.</code></pre>
<div class="help-column_heading">Initialization</div></div>
<div class="old-help-para">Multiple declarations can be defined in one line if they aren't initialized,
but each initialization should be done on a separate line.</div>
<div class="old-help-para"><pre><code class="language-c">int i;
int j; // GOOD
int i, j;   // GOOD: multiple declarations, no initialization.
int i = 0;
int j = 0;  // GOOD: one initialization per line.
int i = 0, j;  // BAD: multiple declarations with initialization.
int i = 0, j = 0;  // BAD: multiple declarations with initialization.</code></pre>
<h2 id="_-nvim-specific-magic" class="help-heading">Nvim-Specific Magic</h2></div>
<div class="old-help-para"><div class="help-column_heading">clint</div></div>
<div class="old-help-para">Use <code>clint.py</code> to detect style errors.</div>
<div class="old-help-para"><code>src/clint.py</code> is a Python script that reads a source file and identifies
style errors. It is not perfect, and has both false positives and false
negatives, but it is still a valuable tool. False positives can be ignored by
putting <code>// NOLINT</code> at the end of the line.</div>
<div class="old-help-para"><div class="help-column_heading">uncrustify</div></div>
<div class="old-help-para">src/uncrustify.cfg is the authority for expected code formatting, for cases
not covered by clint.py.  We remove checks in clint.py if they are covered by
uncrustify rules.</div>
<div class="old-help-para"><h2 id="dev-style-features" class="help-heading">Other C Features<span class="help-heading-tags">                                        <span class="help-tag"><a href="#dev-style-features">dev-style-features</a></span></h2></div>
<div class="old-help-para"><div class="help-column_heading">Variable-Length Arrays and alloca()</div></div>
<div class="old-help-para">We do not allow variable-length arrays or <code>alloca()</code>.</div>
<div class="old-help-para">Variable-length arrays can cause hard to detect stack overflows.</div>
<div class="old-help-para"><div class="help-column_heading">Postincrement and Postdecrement</div></div>
<div class="old-help-para">Use postfix form (<code>i++</code>) in statements.<pre><code class="language-c">for (int i = 0; i &lt; 3; i++) { }
int j = ++i;  // OK: ++i is used as an expression.
for (int i = 0; i &lt; 3; ++i) { }
++i;  // BAD: ++i is used as a statement.</code></pre>
<div class="help-column_heading">Use of const</div></div>
<div class="old-help-para">Use <code>const</code> pointers whenever possible. Avoid <code>const</code> on non-pointer parameter definitions.</div>
<div class="old-help-para"><div class="help-column_heading">    Where to put the const</div></div>
<div class="old-help-para">    Some people favor the form <code>int const *foo</code> to <code>const int *foo</code> . They
    argue that this is more readable because it's more consistent: it keeps
    the rule that <code>const</code> always follows the object it's describing. However,
    this consistency argument doesn't apply in codebases with few
    deeply-nested pointer expressions since most <code>const</code> expressions have only
    one <code>const</code>, and it applies to the underlying value. In such cases, there's
    no consistency to maintain. Putting the <code>const</code> first is arguably more
    readable, since it follows English in putting the "adjective" (<code>const</code>)
    before the "noun" (<code>int</code>).</div>
<div class="old-help-para">    That said, while we encourage putting <code>const</code> first, we do not require it.
    But be consistent with the code around you!<pre><code class="language-c">void foo(const char *p, int i);
}
int foo(const int a, const bool b) {
}
int foo(int *const p) {
}</code></pre>
<div class="help-column_heading">Integer Types</div></div>
<div class="old-help-para">Of the built-in integer types only use <code>char</code>, <code>int</code>, <code>uint8_t</code>, <code>int8_t</code>,
<code>uint16_t</code>, <code>int16_t</code>, <code>uint32_t</code>, <code>int32_t</code>, <code>uint64_t</code>, <code>int64_t</code>,
<code>uintmax_t</code>, <code>intmax_t</code>, <code>size_t</code>, <code>ssize_t</code>, <code>uintptr_t</code>, <code>intptr_t</code>, and
<code>ptrdiff_t</code>.</div>
<div class="old-help-para">Use <code>int</code> for error codes and local, trivial variables only.</div>
<div class="old-help-para">Use care when converting integer types. Integer conversions and promotions can
cause non-intuitive behavior. Note that the signedness of <code>char</code> is
implementation defined.</div>
<div class="old-help-para">Public facing types must have fixed width (<code>uint8_t</code>, etc.)</div>
<div class="old-help-para">There are no convenient <code>printf</code> format placeholders for fixed width types.
Cast to <code>uintmax_t</code> or <code>intmax_t</code> if you have to format fixed width integers.</div>
<div class="old-help-para">Type		unsigned    signed
<code>char</code>  		<code>%hhu</code>  	    <code>%hhd</code>
<code>int</code>  		n/a	    <code>%d</code>
<code>(u)intmax_t</code>  	<code>%ju</code>  	    <code>%jd</code>
<code>(s)size_t</code>  	<code>%zu</code>  	    <code>%zd</code>
<code>ptrdiff_t</code>  	<code>%tu</code>  	    <code>%td</code></div>
<div class="old-help-para"><div class="help-column_heading">Booleans</div></div>
<div class="old-help-para">Use <code>bool</code> to represent boolean values.<pre><code class="language-c">int loaded = 1;  // BAD: loaded should have type bool.</code></pre>
<div class="help-column_heading">Conditions</div></div>
<div class="old-help-para">Don't use "yoda-conditions". Use at most one assignment per condition.<pre><code class="language-c">if (1 == x) {
if (x == 1) {  //use this order
if ((x = f()) &amp;&amp; (y = g())) {</code></pre>
<div class="help-column_heading">Function declarations</div></div>
<div class="old-help-para">Every function must not have a separate declaration.</div>
<div class="old-help-para">Function declarations are created by the gen_declarations.lua script.<pre><code class="language-c">static void f(void);
static void f(void)
{
  ...
}</code></pre>
<div class="help-column_heading">General translation unit layout</div></div>
<div class="old-help-para">The definitions of public functions precede the definitions of static
functions.<pre><code class="language-c">&lt;HEADER&gt;
&lt;PUBLIC FUNCTION DEFINITIONS&gt;
&lt;STATIC FUNCTION DEFINITIONS&gt;</code></pre>
<div class="help-column_heading">Integration with declarations generator</div></div>
<div class="old-help-para">Every C file must contain #include of the generated header file, guarded by
#ifdef INCLUDE_GENERATED_DECLARATIONS.</div>
<div class="old-help-para">Include must go after other #includes and typedefs in .c files and after
everything else in header files. It is allowed to omit #include in a .c file
if .c file does not contain any static functions.</div>
<div class="old-help-para">Included file name consists of the .c file name without extension, preceded by
the directory name relative to src/nvim. Name of the file containing static
functions declarations ends with <code>.c.generated.h</code>, <code>*.h.generated.h</code> files
contain only non-static function declarations.<pre><code class="language-c">// src/nvim/foo.c file
#include &lt;stddef.h&gt;
typedef int FooType;
#ifdef INCLUDE_GENERATED_DECLARATIONS
# include "foo.c.generated.h"
#endif
â€¦
// src/nvim/foo.h file
#pragma once
â€¦
#ifdef INCLUDE_GENERATED_DECLARATIONS
# include "foo.h.generated.h"
#endif</code></pre>
<div class="help-column_heading">64-bit Portability</div></div>
<div class="old-help-para">Code should be 64-bit and 32-bit friendly. Bear in mind problems of printing,
comparisons, and structure alignment.</div>
<div class="old-help-para"><div class="help-li" style=""> Remember that <code>sizeof(void *)</code> != <code>sizeof(int)</code>. Use <code>intptr_t</code> if you want
  a pointer-sized integer.
</div></div>
<div class="old-help-para"><div class="help-li" style=""> You may need to be careful with structure alignments, particularly for
  structures being stored on disk. Any class/structure with a
  <code>int64_t</code>/`uint64_t` member will by default end up being 8-byte aligned on a
  64-bit system. If you have such structures being shared on disk between
  32-bit and 64-bit code, you will need to ensure that they are packed the
  same on both architectures. Most compilers offer a way to alter structure
  alignment. For gcc, you can use <code>__attribute__((packed))</code>. MSVC offers
  <code>#pragma pack()</code> and <code>__declspec(align())</code>.
</div></div>
<div class="old-help-para"><div class="help-li" style=""> Use the <code>LL</code> or <code>ULL</code> suffixes as needed to create 64-bit constants. For
  example:<pre><code class="language-c">int64_t my_value = 0x123456789LL;
uint64_t my_mask = 3ULL &lt;&lt; 48;</code></pre>
sizeof ~
</div></div>
<div class="old-help-para">Prefer <code>sizeof(varname)</code> to <code>sizeof(type)</code>.</div>
<div class="old-help-para">Use <code>sizeof(varname)</code> when you take the size of a particular variable.
<code>sizeof(varname)</code> will update appropriately if someone changes the variable
type either now or later. You may use <code>sizeof(type)</code> for code unrelated to any
particular variable, such as code that manages an external or internal data
format where a variable of an appropriate C type is not convenient.<pre><code class="language-c">Struct data;
memset(&amp;data, 0, sizeof(data));
memset(&amp;data, 0, sizeof(Struct));
if (raw_size &lt; sizeof(int)) {
  fprintf(stderr, "compressed record not big enough for count: %ju", raw_size);
  return false;
}</code></pre>
<h2 id="dev-style-naming" class="help-heading">Naming<span class="help-heading-tags">                                                  <span class="help-tag"><a href="#dev-style-naming">dev-style-naming</a></span></h2></div>
<div class="old-help-para">The most important consistency rules are those that govern naming. The style
of a name immediately informs us what sort of thing the named entity is: a
type, a variable, a function, a constant, a macro, etc., without requiring us
to search for the declaration of that entity. The pattern-matching engine in
our brains relies a great deal on these naming rules.</div>
<div class="old-help-para">Naming rules are pretty arbitrary, but we feel that consistency is more
important than individual preferences in this area, so regardless of whether
you find them sensible or not, the rules are the rules.</div>
<div class="old-help-para"><div class="help-column_heading">General Naming Rules</div></div>
<div class="old-help-para">Function names, variable names, and filenames should be descriptive; eschew
abbreviation.</div>
<div class="old-help-para">Give as descriptive a name as possible, within reason. Do not worry about
saving horizontal space as it is far more important to make your code
immediately understandable by a new reader. Do not use abbreviations that are
ambiguous or unfamiliar to readers outside your project, and do not abbreviate
by deleting letters within a word.<pre><code class="language-c">int price_count_reader;    // No abbreviation.
int num_errors;            // "num" is a widespread convention.
int num_dns_connections;   // Most people know what "DNS" stands for.
int n;                     // Meaningless.
int nerr;                  // Ambiguous abbreviation.
int n_comp_conns;          // Ambiguous abbreviation.
int wgc_connections;       // Only your group knows what this stands for.
int pc_reader;             // Lots of things can be abbreviated "pc".
int cstmr_id;              // Deletes internal letters.</code></pre>
<div class="help-column_heading">File Names</div></div>
<div class="old-help-para">Filenames should be all lowercase and can include underscores (<code>_</code>).</div>
<div class="old-help-para">Use underscores to separate words. Examples of acceptable file names:<pre>my_useful_file.c
getline_fix.c  // OK: getline refers to the glibc function.</pre>
C files should end in <code>.c</code> and header files should end in <code>.h</code>.</div>
<div class="old-help-para">Do not use filenames that already exist in <code>/usr/include</code>, such as <code>db.h</code>.</div>
<div class="old-help-para">In general, make your filenames very specific. For example, use
<code>http_server_logs.h</code> rather than <code>logs.h</code>.</div>
<div class="old-help-para"><div class="help-column_heading">Type Names</div></div>
<div class="old-help-para">Typedef-ed structs and enums start with a capital letter and have a capital
letter for each new word, with no underscores: <code>MyExcitingStruct</code>.</div>
<div class="old-help-para">Non-Typedef-ed structs and enums are all lowercase with underscores between
words: <code>struct my_exciting_struct</code> .<pre><code class="language-c">struct my_struct {
  ...
};
typedef struct my_struct MyAwesomeStruct;</code></pre>
<div class="help-column_heading">Variable Names</div></div>
<div class="old-help-para">Variable names are all lowercase, with underscores between words. For
instance: <code>my_exciting_local_variable</code>.</div>
<div class="old-help-para"><div class="help-column_heading">    Common Variable names</div></div>
<div class="old-help-para">    For example:<pre><code class="language-c">string table_name;  // OK: uses underscore.
string tablename;   // OK: all lowercase.
string tableName;   // BAD: mixed case.</code></pre></div>
<div class="old-help-para"><div class="help-column_heading">    Struct Variables</div></div>
<div class="old-help-para">    Data members in structs should be named like regular variables.<pre><code class="language-c">struct url_table_properties {
  string name;
  int num_entries;
}</code></pre></div>
<div class="old-help-para"><div class="help-column_heading">    Global Variables</div></div>
<div class="old-help-para">    Don't use global variables unless absolutely necessary. Prefix global
    variables with <code>g_</code>.</div>
<div class="old-help-para"><div class="help-column_heading">Constant Names</div></div>
<div class="old-help-para">Use a <code>k</code> followed by mixed case: <code>kDaysInAWeek</code>.</div>
<div class="old-help-para">All compile-time constants, whether they are declared locally or globally,
follow a slightly different naming convention from other variables. Use a <code>k</code>
followed by words with uppercase first letters:<pre><code class="language-c">const int kDaysInAWeek = 7;</code></pre>
<div class="help-column_heading">Function Names</div></div>
<div class="old-help-para">Function names are all lowercase, with underscores between words. For
instance: <code>my_exceptional_function()</code>. All functions in the same header file
should have a common prefix.</div>
<div class="old-help-para">In <code>os_unix.h</code>:<pre><code class="language-c">void unix_open(const char *path);
void unix_user_id(void);</code></pre>
If your function crashes upon an error, you should append <code>or_die</code> to the
function name. This only applies to functions which could be used by
production code and to errors that are reasonably likely to occur during
normal operation.</div>
<div class="old-help-para"><div class="help-column_heading">Enumerator Names</div></div>
<div class="old-help-para">Enumerators should be named like constants: <code>kEnumName</code>.<pre><code class="language-c">enum url_table_errors {
  kOK = 0,
  kErrorOutOfMemory,
  kErrorMalformedInput,
};</code></pre>
<div class="help-column_heading">Macro Names</div></div>
<div class="old-help-para">They're like this: <code>MY_MACRO_THAT_SCARES_CPP_DEVELOPERS</code>.<pre><code class="language-c">#define ROUND(x) ...
#define PI_ROUNDED 5.0</code></pre>
<h2 id="dev-style-comments" class="help-heading">Comments<span class="help-heading-tags">                                                <span class="help-tag"><a href="#dev-style-comments">dev-style-comments</a></span></h2></div>
<div class="old-help-para">Comments are vital to keeping our code readable. The following rules describe
what you should comment and where. But remember: while comments are very
important, the best code is self-documenting.</div>
<div class="old-help-para">When writing your comments, write for your audience: the next contributor who
will need to understand your code. Be generous â€” the next one may be you!</div>
<div class="old-help-para">Nvim uses Doxygen comments.</div>
<div class="old-help-para"><div class="help-column_heading">Comment Style</div></div>
<div class="old-help-para">Use the <code>//</code>-style syntax only.<pre><code class="language-c">// This is a comment spanning
// multiple lines
f();</code></pre>
<div class="help-column_heading">File Comments</div></div>
<div class="old-help-para">Start each file with a description of its contents.</div>
<div class="old-help-para"><div class="help-column_heading">    Legal Notice</div></div>
<div class="old-help-para">    We have no such thing. These things are in LICENSE and only there.</div>
<div class="old-help-para"><div class="help-column_heading">    File Contents</div></div>
<div class="old-help-para">    Every file should have a comment at the top describing its contents.</div>
<div class="old-help-para">    Generally a <code>.h</code> file will describe the variables and functions that are
    declared in the file with an overview of what they are for and how they
    are used. A <code>.c</code> file should contain more information about implementation
    details or discussions of tricky algorithms. If you feel the
    implementation details or a discussion of the algorithms would be useful
    for someone reading the <code>.h</code>, feel free to put it there instead, but
    mention in the <code>.c</code> that the documentation is in the <code>.h</code> file.</div>
<div class="old-help-para">    Do not duplicate comments in both the <code>.h</code> and the <code>.c</code>. Duplicated
    comments diverge.<pre><code class="language-c">/// A brief description of this file.
///
/// A longer description of this file.
/// Be very generous here.</code></pre>
<div class="help-column_heading">Struct Comments</div></div>
<div class="old-help-para">Every struct definition should have accompanying comments that describes what
it is for and how it should be used.<pre><code class="language-c">/// Window info stored with a buffer.
///
/// Two types of info are kept for a buffer which are associated with a
/// specific window:
/// 1. Each window can have a different line number associated with a
/// buffer.
/// 2. The window-local options for a buffer work in a similar way.
/// The window-info is kept in a list at g_wininfo.  It is kept in
/// most-recently-used order.
struct win_info {
  /// Next entry or NULL for last entry.
  WinInfo *wi_next;
  /// Previous entry or NULL for first entry.
  WinInfo *wi_prev;
  /// Pointer to window that did the wi_fpos.
  Win *wi_win;
  ...
};</code></pre>
If the field comments are short, you can also put them next to the field. But
be consistent within one struct, and follow the necessary doxygen style.<pre><code class="language-c">struct wininfo_S {
  WinInfo *wi_next;  ///&lt; Next entry or NULL for last entry.
  WinInfo *wi_prev;  ///&lt; Previous entry or NULL for first entry.
  Win *wi_win;       ///&lt; Pointer to window that did the wi_fpos.
  ...
};</code></pre>
If you have already described a struct in detail in the comments at the top of
your file feel free to simply state "See comment at top of file for a complete
description", but be sure to have some sort of comment.</div>
<div class="old-help-para">Document the synchronization assumptions the struct makes, if any. If an
instance of the struct can be accessed by multiple threads, take extra care to
document the rules and invariants surrounding multithreaded use.</div>
<div class="old-help-para"><div class="help-column_heading">Function Comments</div></div>
<div class="old-help-para">Declaration comments describe use of the function; comments at the definition
of a function describe operation.</div>
<div class="old-help-para"><div class="help-column_heading">    Function Declarations</div></div>
<div class="old-help-para">    Every function declaration should have comments immediately preceding it
    that describe what the function does and how to use it. These comments
    should be descriptive ("Opens the file") rather than imperative ("Open the
    file"); the comment describes the function, it does not tell the function
    what to do. In general, these comments do not describe how the function
    performs its task. Instead, that should be left to comments in the
    function definition.</div>
<div class="old-help-para">    Types of things to mention in comments at the function declaration:</div>
<div class="old-help-para"><div class="help-li" style=""> If the function allocates memory that the caller must free.
</div><div class="help-li" style=""> Whether any of the arguments can be a null pointer.
</div><div class="help-li" style=""> If there are any performance implications of how a function is used.
</div><div class="help-li" style=""> If the function is re-entrant. What are its synchronization assumptions?
<pre><code class="language-c">/// Brief description of the function.
///
/// Detailed description.
/// May span multiple paragraphs.
///
/// @param arg1 Description of arg1
/// @param arg2 Description of arg2. May span
///        multiple lines.
///
/// @return Description of the return value.
Iterator *get_iterator(void *arg1, void *arg2);</code></pre></div></div>
<div class="old-help-para"><div class="help-column_heading">    Function Definitions</div></div>
<div class="old-help-para">    If there is anything tricky about how a function does its job, the
    function definition should have an explanatory comment. For example, in
    the definition comment you might describe any coding tricks you use, give
    an overview of the steps you go through, or explain why you chose to
    implement the function in the way you did rather than using a viable
    alternative. For instance, you might mention why it must acquire a lock
    for the first half of the function but why it is not needed for the second
    half.</div>
<div class="old-help-para">    Note you should not just repeat the comments given with the function
    declaration, in the <code>.h</code> file or wherever. It's okay to recapitulate
    briefly what the function does, but the focus of the comments should be on
    how it does it.<pre><code class="language-c">// Note that we don't use Doxygen comments here.
Iterator *get_iterator(void *arg1, void *arg2)
{
  ...
}</code></pre>
<div class="help-column_heading">Variable Comments</div></div>
<div class="old-help-para">In general the actual name of the variable should be descriptive enough to
give a good idea of what the variable is used for. In certain cases, more
comments are required.</div>
<div class="old-help-para"><div class="help-column_heading">    Global Variables</div></div>
<div class="old-help-para">    All global variables should have a comment describing what they are and
    what they are used for. For example:<pre><code class="language-c">/// The total number of tests cases that we run
/// through in this regression test.
const int kNumTestCases = 6;</code></pre>
<div class="help-column_heading">Implementation Comments</div></div>
<div class="old-help-para">In your implementation you should have comments in tricky, non-obvious,
interesting, or important parts of your code.</div>
<div class="old-help-para"><div class="help-column_heading">    Line Comments</div></div>
<div class="old-help-para">    Also, lines that are non-obvious should get a comment at the end of the
    line. These end-of-line comments should be separated from the code by 2
    spaces. Example:<pre><code class="language-c">// If we have enough memory, mmap the data portion too.
mmap_budget = max&lt;int64&gt;(0, mmap_budget - index_-&gt;length());
if (mmap_budget &gt;= data_size_ &amp;&amp; !MmapData(mmap_chunk_bytes, mlock)) {
  return;  // Error already logged.
}</code></pre></div>
<div class="old-help-para">    Note that there are both comments that describe what the code is doing,
    and comments that mention that an error has already been logged when the
    function returns.</div>
<div class="old-help-para">    If you have several comments on subsequent lines, it can often be more
    readable to line them up:<pre><code class="language-c">do_something();                      // Comment here so the comments line up.
do_something_else_that_is_longer();  // Comment here so there are two spaces between
                                     // the code and the comment.
{ // One space before comment when opening a new scope is allowed,
  // thus the comment lines up with the following comments and code.
  do_something_else();  // Two spaces before line comments normally.
}</code></pre></div>
<div class="old-help-para"><div class="help-column_heading">    NULL, true/false, 1, 2, 3...</div></div>
<div class="old-help-para">    When you pass in a null pointer, boolean, or literal integer values to
    functions, you should consider adding a comment about what they are, or
    make your code self-documenting by using constants. For example, compare:
<pre><code class="language-c">bool success = calculate_something(interesting_value,
                                   10,
                                   false,
                                   NULL);  // What are these arguments??</code></pre></div>
<div class="old-help-para">    versus:<pre><code class="language-c">bool success = calculate_something(interesting_value,
                                   10,     // Default base value.
                                   false,  // Not the first time we're calling this.
                                   NULL);  // No callback.</code></pre></div>
<div class="old-help-para">    Or alternatively, constants or self-describing variables:<pre><code class="language-c">const int kDefaultBaseValue = 10;
const bool kFirstTimeCalling = false;
Callback *null_callback = NULL;
bool success = calculate_something(interesting_value,
                                   kDefaultBaseValue,
                                   kFirstTimeCalling,
                                   null_callback);</code></pre></div>
<div class="old-help-para"><div class="help-column_heading">    Don'ts</div></div>
<div class="old-help-para">    Note that you should never describe the code itself. Assume that the
    person reading the code knows C better than you do, even though he or she
    does not know what you are trying to do:<pre><code class="language-c">// Now go through the b array and make sure that if i occurs,
// the next element is i+1.
...        // Geez.  What a useless comment.</code></pre>
<div class="help-column_heading">Punctuation, Spelling and Grammar</div></div>
<div class="old-help-para">Pay attention to punctuation, spelling, and grammar; it is easier to read
well-written comments than badly written ones.</div>
<div class="old-help-para">Comments should be as readable as narrative text, with proper capitalization
and punctuation. In many cases, complete sentences are more readable than
sentence fragments. Shorter comments, such as comments at the end of a line of
code, can sometimes be less formal, but you should be consistent with your
style.</div>
<div class="old-help-para">Although it can be frustrating to have a code reviewer point out that you are
using a comma when you should be using a semicolon, it is very important that
source code maintain a high level of clarity and readability. Proper
punctuation, spelling, and grammar help with that goal.</div>
<div class="old-help-para"><div class="help-column_heading">TODO Comments</div></div>
<div class="old-help-para">Use <code>TODO</code> comments for code that is temporary, a short-term solution, or
good-enough but not perfect.</div>
<div class="old-help-para"><code>TODO</code>s should include the string <code>TODO</code> in all caps, followed by the name,
email address, or other identifier of the person who can best provide context
about the problem referenced by the <code>TODO</code>. The main purpose is to have a
consistent <code>TODO</code> format that can be searched to find the person who can
provide more details upon request. A <code>TODO</code> is not a commitment that the
person referenced will fix the problem. Thus when you create a <code>TODO</code>, it is
almost always your name that is given.<pre><code class="language-c">// TODO(kl@gmail.com): Use a "*" here for concatenation operator.
// TODO(Zeke): change this to use relations.</code></pre>
If your <code>TODO</code> is of the form "At a future date do something" make sure that
you either include a very specific date ("Fix by November 2005") or a very
specific event ("Remove this code when all clients can handle XML
responses.").</div>
<div class="old-help-para"><div class="help-column_heading">Deprecation Comments</div></div>
<div class="old-help-para">Mark deprecated interface points with <code>@deprecated</code> docstring token.</div>
<div class="old-help-para">You can mark an interface as deprecated by writing a comment containing the
word <code>@deprecated</code> in all caps. The comment goes either before the declaration
of the interface or on the same line as the declaration.</div>
<div class="old-help-para">After <code>@deprecated</code>, write your name, email, or other identifier in
parentheses.</div>
<div class="old-help-para">A deprecation comment must include simple, clear directions for people to fix
their callsites. In C, you can implement a deprecated function as an inline
function that calls the new interface point.</div>
<div class="old-help-para">Marking an interface point <code>DEPRECATED</code> will not magically cause any callsites
to change. If you want people to actually stop using the deprecated facility,
you will have to fix the callsites yourself or recruit a crew to help you.</div>
<div class="old-help-para">New code should not contain calls to deprecated interface points. Use the new
interface point instead. If you cannot understand the directions, find the
person who created the deprecation and ask them for help using the new
interface point.</div>
<div class="old-help-para"><h2 id="dev-style-format" class="help-heading">Formatting<span class="help-heading-tags">                                              <span class="help-tag"><a href="#dev-style-format">dev-style-format</a></span></h2></div>
<div class="old-help-para">Coding style and formatting are pretty arbitrary, but a project is much easier
to follow if everyone uses the same style. Individuals may not agree with
every aspect of the formatting rules, and some of the rules may take some
getting used to, but it is important that all project contributors follow the
style rules so that they can all read and understand everyone's code easily.</div>
<div class="old-help-para"><div class="help-column_heading">Non-ASCII Characters</div></div>
<div class="old-help-para">Non-ASCII characters should be rare, and must use UTF-8 formatting.</div>
<div class="old-help-para">You shouldn't hard-code user-facing text in source (OR SHOULD YOU?), even
English, so use of non-ASCII characters should be rare. However, in certain
cases it is appropriate to include such words in your code. For example, if
your code parses data files from foreign sources, it may be appropriate to
hard-code the non-ASCII string(s) used in those data files as delimiters. More
commonly, unittest code (which does not need to be localized) might contain
non-ASCII strings. In such cases, you should use UTF-8, since that is an
encoding understood by most tools able to handle more than just ASCII.</div>
<div class="old-help-para">Hex encoding is also OK, and encouraged where it enhances readability â€” for
example, <code>"\uFEFF"</code>, is the Unicode zero-width no-break space character, which
would be invisible if included in the source as straight UTF-8.</div>
<div class="old-help-para"><div class="help-column_heading">Braced Initializer Lists</div></div>
<div class="old-help-para">Format a braced list exactly like you would format a function call in its
place but with one space after the <code>{</code> and one space before the <code>}</code></div>
<div class="old-help-para">If the braced list follows a name (e.g. a type or variable name), format as if
the <code>{}</code> were the parentheses of a function call with that name. If there is
no name, assume a zero-length name.<pre><code class="language-c">struct my_struct m = {  // Here, you could also break before {.
    superlongvariablename1,
    superlongvariablename2,
    { short, interior, list },
    { interiorwrappinglist,
      interiorwrappinglist2 } };</code></pre>
<div class="help-column_heading">Loops and Switch Statements</div></div>
<div class="old-help-para">Annotate non-trivial fall-through between cases.</div>
<div class="old-help-para">If not conditional on an enumerated value, switch statements should always
have a <code>default</code> case (in the case of an enumerated value, the compiler will
warn you if any values are not handled). If the default case should never
execute, simply use <code>abort()</code>:<pre><code class="language-c">switch (var) {
  case 0:
    ...
    break;
  case 1:
    ...
    break;
  default:
    abort();
}</code></pre>
Switch statements that are conditional on an enumerated value should not have
a <code>default</code> case if it is exhaustive. Explicit case labels are preferred over
<code>default</code>, even if it leads to multiple case labels for the same code. For
example, instead of:<pre><code class="language-c">case A:
  ...
case B:
  ...
case C:
  ...
default:
  ...</code></pre>
You should use:<pre><code class="language-c">case A:
  ...
case B:
  ...
case C:
  ...
case D:
case E:
case F:
  ...</code></pre>
Certain compilers do not recognize an exhaustive enum switch statement as
exhaustive, which causes compiler warnings when there is a return statement in
every case of a switch statement, but no catch-all return statement. To fix
these spurious errors, you are advised to use <code>UNREACHABLE</code> after the switch
statement to explicitly tell the compiler that the switch statement always
returns and any code after it is unreachable. For example:<pre><code class="language-c">enum { A, B, C } var;
...
switch (var) {
  case A:
    return 1;
  case B:
    return 2;
  case C:
    return 3;
}
UNREACHABLE;</code></pre>
<div class="help-column_heading">Return Values</div></div>
<div class="old-help-para">Do not needlessly surround the <code>return</code> expression with parentheses.</div>
<div class="old-help-para">Use parentheses in <code>return expr</code>; only where you would use them inx =
expr;`.<pre><code class="language-c">return result;
return (some_long_condition &amp;&amp; another_condition);
return (value);  // You wouldn't write var = (value);
return(result);  // return is not a function!</code></pre>
<div class="help-column_heading">Horizontal Whitespace</div></div>
<div class="old-help-para">Use of horizontal whitespace depends on location.</div>
<div class="old-help-para"><div class="help-column_heading">    Variables</div><pre><code class="language-c">int long_variable = 0;  // Don't align assignments.
int i             = 1;
struct my_struct {  // Exception: struct arrays.
  const char *boy;
  const char *girl;
  int pos;
} my_variable[] = {
  { "Mia",       "Michael", 8  },
  { "Elizabeth", "Aiden",   10 },
  { "Emma",      "Mason",   2  },
};</code></pre></div>
<div class="old-help-para"><h2 id="_-parting-words" class="help-heading">Parting Words</h2></div>
<div class="old-help-para">The style guide is intended to make the code more readable. If you think you
must violate its rules for the sake of clarity, do it! But please add a note
to your pull request explaining your reasoning.</div>
<a class="unknown-token" target="_blank" title="Report bug... (unhandled token "modeline")" href="https://github.com/neovim/neovim/issues/new?labels=bug&title=user+docs+HTML%3A+dev_style.txt+&body=%60gen_help_html.lua%60+problem+at%3A+https://neovim.io/doc/user/dev_style.html%0D+unhandled+token%3A+%60modeline%60%0DContext%3A%0D%0D%60%60%60%0Dto%20your%20pull%20request%20explaining%20your%20reasoning.%0A%0A%0A%20vim%3Atw%3D78%3Ats%3D8%3Aet%3Aft%3Dhelp%3Anorl%3A%0D%60%60%60">vim:tw=78:ts=8:et:ft=help:norl:</a>
  </div>
      <div class="col-narrow toc">
      <div><a href="index.html">Main</a></div>
      <div><a href="vimindex.html">Commands index</a></div>
      <div><a href="quickref.html">Quick reference</a></div>
      <hr/>
  <div class="help-toc-h1"><a href="#_-background">
Background</a>
</div><div class="help-toc-h1"><a href="#dev-style-header">
Header Files                                            </a>
</div><div class="help-toc-h1"><a href="#dev-style-scope">
Scoping                                                 </a>
</div><div class="help-toc-h1"><a href="#_-nvim-specific-magic">
Nvim-Specific Magic</a>
</div><div class="help-toc-h1"><a href="#dev-style-features">
Other C Features                                        </a>
</div><div class="help-toc-h1"><a href="#dev-style-naming">
Naming                                                  </a>
</div><div class="help-toc-h1"><a href="#dev-style-comments">
Comments                                                </a>
</div><div class="help-toc-h1"><a href="#dev-style-format">
Formatting                                              </a>
</div><div class="help-toc-h1"><a href="#_-parting-words">
Parting Words</a>
</div></div>
</div>
  <footer>
    <div class="container flex">
      <div class="generator-stats">
        Generated at 2024-03-26 05:22 from <code><a href="https://github.com/neovim/neovim/commit/00e71d3da3464df2b4c4f33bfd5fac6d88e7c867">00e71d3</a></code>
      </div>
      <div class="generator-stats">
      parse_errors: 0 (<a href="https://github.com/neovim/neovim/issues/new?labels=bug&title=user+docs+HTML%3A+dev_style.txt+&body=%60gen_help_html.lua%60+problem+at%3A+https://neovim.io/doc/user/dev_style.html%0D%0DContext%3A%0D%0D%60%60%60%0DTODO%0D%60%60%60" target="_blank">report docs bug...</a>) | <span title="          Nvim
                            NVIM REFERENCE MANUAL
                                      Type &lt;a href="various.html#gO"&gt;gO&lt;/a&gt; to see the table of contents.">noise_lines: 3</span>
      </div>
    <div>

    <!-- algolia docsearch https://docsearch.algolia.com/docs/docsearch-v3/ -->
    <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
    <script type="module">
      docsearch({
        container: '#docsearch',
        appId: 'X185E15FPG',
        apiKey: 'b5e6b2f9c636b2b471303205e59832ed',
        indexName: 'nvim',
      });
    </script>

  </footer>
  </body>
</html>
