  <!DOCTYPE html>
  <html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Neovim user documentation">

    <!-- algolia docsearch https://docsearch.algolia.com/docs/docsearch-v3/ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />
    <link rel="preconnect" href="https://X185E15FPG-dsn.algolia.net" crossorigin />

    <link href="/css/normalize.min.css" rel="stylesheet">
    <link href="/css/bootstrap.css" rel="stylesheet">
    <link href="/css/main.css" rel="stylesheet">
    <link href="help.css" rel="stylesheet">
    <link href="/highlight/styles/neovim.min.css" rel="stylesheet">

    <script src="/highlight/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <title> Userfunc - Neovim docs</title>
  </head>
  <body>
    <header class="container">
    <nav class="navbar navbar-expand-lg">
      <div class="container-fluid">
        <a href="/" class="navbar-brand" aria-label="logo">
          <!--TODO: use <img src="â€¦.svg"> here instead. Need one that has green lettering instead of gray. -->
              <svg xmlns="http://www.w3.org/2000/svg" role="img" width="173" height="50" viewBox="0 0 742 214" aria-label="Neovim">
      <title>Neovim</title>
      <defs>
        <linearGradient x1="50%" y1="0%" x2="50%" y2="100%" id="a">
          <stop stop-color="#16B0ED" stop-opacity=".8" offset="0%" />
          <stop stop-color="#0F59B2" stop-opacity=".837" offset="100%" />
        </linearGradient>
        <linearGradient x1="50%" y1="0%" x2="50%" y2="100%" id="b">
          <stop stop-color="#7DB643" offset="0%" />
          <stop stop-color="#367533" offset="100%" />
        </linearGradient>
        <linearGradient x1="50%" y1="0%" x2="50%" y2="100%" id="c">
          <stop stop-color="#88C649" stop-opacity=".8" offset="0%" />
          <stop stop-color="#439240" stop-opacity=".84" offset="100%" />
        </linearGradient>
      </defs>
      <g fill="none" fill-rule="evenodd">
        <path
          d="M.027 45.459L45.224-.173v212.171L.027 166.894V45.459z"
          fill="url(#a)"
          transform="translate(1 1)"
        />
        <path
          d="M129.337 45.89L175.152-.149l-.928 212.146-45.197-45.104.31-121.005z"
          fill="url(#b)"
          transform="matrix(-1 0 0 1 305 1)"
        />
        <path
          d="M45.194-.137L162.7 179.173l-32.882 32.881L12.25 33.141 45.194-.137z"
          fill="url(#c)"
          transform="translate(1 1)"
        />
        <path
          d="M46.234 84.032l-.063 7.063-36.28-53.563 3.36-3.422 32.983 49.922z"
          fill-opacity=".13"
          fill="#000"
        />
        <g fill="#444">
          <path
            d="M227 154V64.44h4.655c1.55 0 2.445.75 2.685 2.25l.806 13.502c4.058-5.16 8.786-9.316 14.188-12.466 5.4-3.15 11.413-4.726 18.037-4.726 4.893 0 9.205.781 12.935 2.34 3.729 1.561 6.817 3.811 9.264 6.751 2.448 2.942 4.297 6.48 5.55 10.621 1.253 4.14 1.88 8.821 1.88 14.042V154h-8.504V96.754c0-8.402-1.91-14.987-5.729-19.757-3.82-4.771-9.667-7.156-17.544-7.156-5.851 0-11.28 1.516-16.292 4.545-5.013 3.032-9.489 7.187-13.427 12.467V154H227zM350.624 63c5.066 0 9.755.868 14.069 2.605 4.312 1.738 8.052 4.268 11.219 7.592s5.638 7.412 7.419 12.264C385.11 90.313 386 95.883 386 102.17c0 1.318-.195 2.216-.588 2.696-.393.48-1.01.719-1.851.719h-64.966v1.70c0 6.708.784 12.609 2.353 17.7 1.567 5.09 3.8 9.357 6.695 12.802 2.895 3.445 6.393 6.034 10.495 7.771 4.1 1.738 8.686 2.606 13.752 2.606 4.524 0 8.446-.494 11.762-1.483 3.317-.988 6.108-2.097 8.37-3.324 2.261-1.227 4.056-2.336 5.383-3.324 1.326-.988 2.292-1.482 2.895-1.482.784 0 1.388.3 1.81.898l2.352 2.875c-1.448 1.797-3.362 3.475-5.745 5.031-2.383 1.558-5.038 2.891-7.962 3.998-2.926 1.109-6.062 1.991-9.41 2.65a52.21 52.21 0 01-10.088.989c-6.152 0-11.762-1.064-16.828-3.19-5.067-2.125-9.415-5.225-13.043-9.298-3.63-4.074-6.435-9.06-8.415-14.96C310.99 121.655 310 114.9 310 107.294c0-6.408.92-12.323 2.76-17.744 1.84-5.421 4.493-10.093 7.961-14.016 3.467-3.922 7.72-6.991 12.758-9.209C338.513 64.11 344.229 63 350.624 63zm.573 6c-4.696 0-8.904.702-12.623 2.105-3.721 1.404-6.936 3.421-9.65 6.053-2.713 2.631-4.908 5.79-6.586 9.474S319.55 94.439 319 99h60c0-4.679-.672-8.874-2.013-12.588-1.343-3.712-3.232-6.856-5.67-9.43-2.44-2.571-5.367-4.545-8.782-5.92-3.413-1.374-7.192-2.062-11.338-2.062zM435.546 63c6.526 0 12.368 1.093 17.524 3.28 5.154 2.186 9.5 5.286 13.04 9.298 3.538 4.013 6.238 8.85 8.099 14.51 1.861 5.66 2.791 11.994 2.791 19.002 0 7.008-.932 13.327-2.791 18.957-1.861 5.631-4.561 10.452-8.099 14.465-3.54 4.012-7.886 7.097-13.04 9.254-5.156 2.156-10.998 3.234-17.524 3.234-6.529 0-12.369-1.078-17.525-3.234-5.155-2.157-9.517-5.242-13.085-9.254-3.57-4.013-6.285-8.836-8.145-14.465-1.861-5.63-2.791-11.95-2.791-18.957 0-7.008.93-13.342 2.791-19.002 1.861-5.66 4.576-10.496 8.145-14.51 3.568-4.012 7.93-7.112 13.085-9.299C423.177 64.094 429.017 63 435.546 63zm-.501 86c5.341 0 10.006-.918 13.997-2.757 3.99-1.838 7.32-4.474 9.992-7.909 2.67-3.435 4.664-7.576 5.986-12.428 1.317-4.85 1.98-10.288 1.98-16.316 0-5.965-.66-11.389-1.98-16.27-1.322-4.88-3.316-9.053-5.986-12.519-2.67-3.463-6-6.13-9.992-7.999-3.991-1.867-8.657-2.802-13.997-2.802s-10.008.935-13.997 2.802c-3.991 1.87-7.322 4.536-9.992 8-2.671 3.465-4.68 7.637-6.03 12.518-1.35 4.881-2.026 10.305-2.026 16.27 0 6.026.675 11.465 2.025 16.316 1.35 4.852 3.36 8.993 6.031 12.428 2.67 3.435 6 6.07 9.992 7.91 3.99 1.838 8.656 2.756 13.997 2.756z"
            fill="currentColor"
          />
          <path
            d="M530.57 152h-20.05L474 60h18.35c1.61 0 2.967.39 4.072 1.166 1.103.778 1.865 1.763 2.283 2.959l17.722 49.138a92.762 92.762 0 012.551 8.429c.686 2.751 1.298 5.5 1.835 8.25.537-2.75 1.148-5.499 1.835-8.25a77.713 77.713 0 012.64-8.429l18.171-49.138c.417-1.196 1.164-2.181 2.238-2.96 1.074-.776 2.356-1.165 3.849-1.165H567l-36.43 92zM572 61h23v92h-23zM610 153V60.443h13.624c2.887 0 4.78 1.354 5.682 4.06l1.443 6.856a52.7 52.7 0 015.097-4.962 32.732 32.732 0 015.683-3.879 30.731 30.731 0 016.496-2.57c2.314-.632 4.855-.948 7.624-.948 5.832 0 10.63 1.579 14.39 4.736 3.758 3.157 6.57 7.352 8.434 12.585 1.444-3.068 3.248-5.698 5.413-7.894 2.165-2.194 4.541-3.984 7.127-5.367a32.848 32.848 0 018.254-3.068 39.597 39.597 0 018.796-.992c5.111 0 9.653.783 13.622 2.345 3.97 1.565 7.307 3.849 10.014 6.857 2.706 3.007 4.766 6.675 6.18 11.005C739.29 83.537 740 88.5 740 94.092V153h-22.284V94.092c0-5.894-1.294-10.329-3.878-13.306-2.587-2.977-6.376-4.465-11.368-4.465-2.286 0-4.404.391-6.358 1.172a15.189 15.189 0 00-5.144 3.383c-1.473 1.474-2.631 3.324-3.474 5.548-.842 2.225-1.263 4.781-1.263 7.668V153h-22.37V94.092c0-6.194-1.249-10.704-3.744-13.532-2.497-2.825-6.18-4.24-11.051-4.24-3.19 0-6.18.798-8.976 2.391-2.799 1.593-5.399 3.775-7.804 6.54V153H610zM572 30h23v19h-23z"
            fill="currentColor"
            fill-opacity=".8"
          />
        </g>
      </g>
    </svg>
  
          <!--<img src="https://neovim.io/logos/neovim-logo.svg" width="173" height="50" alt="Neovim" />-->
        </a>
        <div id="docsearch"></div> <!-- algolia docsearch https://docsearch.algolia.com/docs/docsearch-v3/ -->
      </div>
    </nav>
  </header>

  <div class="container golden-grid help-body">
  <div class="col-wide">
  <a name="define-function"></a><h1 id="userfunc.txt"> Userfunc</h1>
  <p>
    <i>
    Nvim <code>:help</code> pages, <a href="https://github.com/neovim/neovim/blob/master/scripts/gen_help_html.lua">generated</a>
    from <a href="https://github.com/neovim/neovim/blob/master/runtime/doc/userfunc.txt">source</a>
    using the <a href="https://github.com/neovim/tree-sitter-vimdoc">tree-sitter-vimdoc</a> parser.
    </i>
  </p>
  <hr/>
  <div class="old-help-para">Defining and using functions.</div>
<div class="old-help-para">This is introduced in section <a href="usr_41.html#41.7">41.7</a> of the user manual.</div>
<div class="old-help-para"><h2 id="_-" class="help-heading"></h2><div class="help-column_heading">1. Defining a function</div>New functions can be defined.  These can be called just like builtin
functions.  The function executes a sequence of Ex commands.  Normal mode
commands can be executed with the <a href="various.html#%3Anormal">:normal</a> command.</div>
<div class="old-help-para">The function name must start with an uppercase letter, to avoid confusion with
builtin functions.  To prevent from using the same name in different scripts
make them script-local.  If you do use a global function then avoid obvious,
short names.  A good habit is to start the function name with the name of the
script, e.g., "HTMLcolor()".</div>
<div class="old-help-para">It is also possible to use curly braces, see <a href="eval.html#curly-braces-names">curly-braces-names</a>.</div>
<div class="old-help-para">The <a href="userfunc.html#autoload">autoload</a> facility is useful to define a function only when it's called.</div>
<div class="old-help-para">							<code id="local-function" class="help-tag-right"><a href="#local-function">local-function</a></code>
A function local to a script must start with "s:".  A local script function
can only be called from within the script and from functions, user commands
and autocommands defined in the script.  It is also possible to call the
function from a mapping defined in the script, but then <a href="map.html#%3CSID%3E">&lt;SID&gt;</a> must be used
instead of "s:" when the mapping is expanded outside of the script.
There are only script-local functions, no buffer-local or window-local
functions.</div>
<div class="old-help-para">					<code id="%3Afu" class="help-tag-right"><a href="#%3Afu">:fu</a></code> <code id="%3Afunction" class="help-tag"><a href="#%3Afunction">:function</a></code> <code id="E128" class="help-tag"><a href="#E128">E128</a></code> <code id="E129" class="help-tag"><a href="#E129">E129</a></code> <code id="E123" class="help-tag"><a href="#E123">E123</a></code>
:fu[nction]		List all functions and their arguments.</div>
<div class="old-help-para">:fu[nction][!] <code>{name}</code>	List function <code>{name}</code>, annotated with line numbers
			unless "!" is given.
			<code>{name}</code> may be a <a href="eval.html#Dictionary">Dictionary</a> <a href="eval.html#Funcref">Funcref</a> entry:<pre>:function dict.init</pre></div>
<div class="old-help-para">			Note that <code>{name}</code> is not an expression, you cannot use
			a variable that is a function reference.  You can use
			this dirty trick to list the function referred to with
			variable "Funcref":<pre>let g:MyFuncref = Funcref
func g:MyFuncref
unlet g:MyFuncref</pre>
:fu[nction] /{pattern}	List functions with a name matching <code>{pattern}</code>.
			Example that lists all functions ending with "File":<pre>:function /File$</pre></div>
<div class="old-help-para">							<code id="%3Afunction-verbose" class="help-tag-right"><a href="#%3Afunction-verbose">:function-verbose</a></code>
When <a href="options.html#'verbose'">'verbose'</a> is non-zero, listing a function will also display where it was
last defined. Example:<pre>:verbose function SetFileTypeSH
    function SetFileTypeSH(name)
        Last set from /usr/share/vim/vim-7.0/filetype.vim</pre></div>
<div class="old-help-para">See <a href="various.html#%3Averbose-cmd">:verbose-cmd</a> for more information.</div>
<div class="old-help-para">						<code id="E124" class="help-tag-right"><a href="#E124">E124</a></code> <code id="E125" class="help-tag"><a href="#E125">E125</a></code> <code id="E853" class="help-tag"><a href="#E853">E853</a></code> <code id="E884" class="help-tag"><a href="#E884">E884</a></code>
:fu[nction][!] <code>{name}</code>([arguments]) [range] [abort] [dict] [closure]
			Define a new function by the name <code>{name}</code>.  The body of
			the function follows in the next lines, until the
			matching <a href="userfunc.html#%3Aendfunction">:endfunction</a>.</div>
<div class="old-help-para">			The name must be made of alphanumeric characters and
			'_', and must start with a capital or "s:" (see
			above).  Note that using "b:" or "g:" is not allowed.
			(since patch 7.4.260 E884 is given if the function
			name has a colon in the name, e.g. for "foo:bar()".
			Before that patch no error was given).</div>
<div class="old-help-para">			<code>{name}</code> may be a <a href="eval.html#Dictionary">Dictionary</a> <a href="eval.html#Funcref">Funcref</a> entry:<pre>:function dict.init(arg)</pre></div>
<div class="old-help-para">			"dict" must be an existing dictionary.  The entry
			"init" is added if it didn't exist yet.  Otherwise [!]
			is required to overwrite an existing function.  The
			result is a <a href="eval.html#Funcref">Funcref</a> to a numbered function.  The
			function can only be used with a <a href="eval.html#Funcref">Funcref</a> and will be
			deleted if there are no more references to it.
								<code id="E127" class="help-tag-right"><a href="#E127">E127</a></code> <code id="E122" class="help-tag"><a href="#E122">E122</a></code>
			When a function by this name already exists and [!] is
			not used an error message is given.  There is one
			exception: When sourcing a script again, a function
			that was previously defined in that script will be
			silently replaced.
			When [!] is used, an existing function is silently
			replaced.  Unless it is currently being executed, that
			is an error.
			NOTE: Use ! wisely.  If used without care it can cause
			an existing function to be replaced unexpectedly,
			which is hard to debug.</div>
<div class="old-help-para">			For the <code>{arguments}</code> see <a href="userfunc.html#function-argument">function-argument</a>.</div>
<div class="old-help-para">					<code id="%3Afunc-range" class="help-tag-right"><a href="#%3Afunc-range">:func-range</a></code> <code id="a%3Afirstline" class="help-tag"><a href="#a%3Afirstline">a:firstline</a></code> <code id="a%3Alastline" class="help-tag"><a href="#a%3Alastline">a:lastline</a></code>
			When the [range] argument is added, the function is
			expected to take care of a range itself.  The range is
			passed as "a:firstline" and "a:lastline".  If [range]
			is excluded, ":{range}call" will call the function for
			each line in the range, with the cursor on the start
			of each line.  See <a href="userfunc.html#function-range-example">function-range-example</a>.
			The cursor is still moved to the first line of the
			range, as is the case with all Ex commands.
								<code id="%3Afunc-abort" class="help-tag-right"><a href="#%3Afunc-abort">:func-abort</a></code>
			When the [abort] argument is added, the function will
			abort as soon as an error is detected.
								<code id="%3Afunc-dict" class="help-tag-right"><a href="#%3Afunc-dict">:func-dict</a></code>
			When the [dict] argument is added, the function must
			be invoked through an entry in a <a href="eval.html#Dictionary">Dictionary</a>.  The
			local variable "self" will then be set to the
			dictionary.  See <a href="eval.html#Dictionary-function">Dictionary-function</a>.
						<code id="%3Afunc-closure" class="help-tag-right"><a href="#%3Afunc-closure">:func-closure</a></code> <code id="E932" class="help-tag"><a href="#E932">E932</a></code>
			When the [closure] argument is added, the function
			can access variables and arguments from the outer
			scope.  This is usually called a closure.  In this
			example Bar() uses "x" from the scope of Foo().  It
			remains referenced even after Foo() returns:<pre>:function! Foo()
:  let x = 0
:  function! Bar() closure
:    let x += 1
:    return x
:  endfunction
:  return funcref('Bar')
:endfunction
:let F = Foo()
:echo F()</pre></div>
<div class="old-help-para">				1<pre>:echo F()</pre></div>
<div class="old-help-para">				2<pre>:echo F()</pre></div>
<div class="old-help-para">				3</div>
<div class="old-help-para">						<code id="function-search-undo" class="help-tag-right"><a href="#function-search-undo">function-search-undo</a></code>
			The last used search pattern and the redo command "."
			will not be changed by the function.  This also
			implies that the effect of <a href="pattern.html#%3Anohlsearch">:nohlsearch</a> is undone
			when the function returns.</div>
<div class="old-help-para">				<code id="%3Aendf" class="help-tag-right"><a href="#%3Aendf">:endf</a></code> <code id="%3Aendfunction" class="help-tag"><a href="#%3Aendfunction">:endfunction</a></code> <code id="E126" class="help-tag"><a href="#E126">E126</a></code> <code id="E193" class="help-tag"><a href="#E193">E193</a></code> <code id="W22" class="help-tag"><a href="#W22">W22</a></code>
:endf[unction] [argument]
			The end of a function definition.  Best is to put it
			on a line by its own, without [argument].</div>
<div class="old-help-para">			[argument] can be:
				| command	command to execute next
				\n command	command to execute next
				" comment	always ignored
				anything else	ignored, warning given when
						<a href="options.html#'verbose'">'verbose'</a> is non-zero
			The support for a following command was added in Vim
			8.0.0654, before that any argument was silently
			ignored.</div>
<div class="old-help-para">			To be able to define a function inside an <code>:execute</code>
			command, use line breaks instead of <a href="cmdline.html#%3Abar">:bar</a>:<pre>:exe "func Foo()\necho 'foo'\nendfunc"</pre></div>
<div class="old-help-para">				<code id="%3Adelf" class="help-tag-right"><a href="#%3Adelf">:delf</a></code> <code id="%3Adelfunction" class="help-tag"><a href="#%3Adelfunction">:delfunction</a></code> <code id="E131" class="help-tag"><a href="#E131">E131</a></code> <code id="E933" class="help-tag"><a href="#E933">E933</a></code>
:delf[unction][!] <code>{name}</code>
			Delete function <code>{name}</code>.
			<code>{name}</code> can also be a <a href="eval.html#Dictionary">Dictionary</a> entry that is a
			<a href="eval.html#Funcref">Funcref</a>:<pre>:delfunc dict.init</pre></div>
<div class="old-help-para">			This will remove the "init" entry from "dict".  The
			function is deleted if there are no more references to
			it.
			With the ! there is no error if the function does not
			exist.
							<code id="%3Aretu" class="help-tag-right"><a href="#%3Aretu">:retu</a></code> <code id="%3Areturn" class="help-tag"><a href="#%3Areturn">:return</a></code> <code id="E133" class="help-tag"><a href="#E133">E133</a></code>
:retu[rn] [expr]	Return from a function.  When "[expr]" is given, it is
			evaluated and returned as the result of the function.
			If "[expr]" is not given, the number 0 is returned.
			When a function ends without an explicit ":return",
			the number 0 is returned.
			Note that there is no check for unreachable lines,
			thus there is no warning if commands follow ":return".
			Also, there is no check if the following
			line contains a valid command.  Forgetting the line
			continuation backslash may go unnoticed:<pre>return 'some text'
       .. ' some more text'</pre></div>
<div class="old-help-para">			Will happily return "some text" without an error.  It
			should have been:<pre>return 'some text'
       \ .. ' some more text'</pre></div>
<div class="old-help-para">			If the ":return" is used after a <a href="eval.html#%3Atry">:try</a> but before the
			matching <a href="eval.html#%3Afinally">:finally</a> (if present), the commands
			following the ":finally" up to the matching <a href="eval.html#%3Aendtry">:endtry</a>
			are executed first.  This process applies to all
			nested ":try"s inside the function.  The function
			returns at the outermost ":endtry".</div>
<div class="old-help-para">						<code id="function-argument" class="help-tag-right"><a href="#function-argument">function-argument</a></code> <code id="a%3Avar" class="help-tag"><a href="#a%3Avar">a:var</a></code>
An argument can be defined by giving its name.  In the function this can then
be used as "a:name" ("a:" for argument).
					<code id="a%3A0" class="help-tag-right"><a href="#a%3A0">a:0</a></code> <code id="a%3A1" class="help-tag"><a href="#a%3A1">a:1</a></code> <code id="a%3A000" class="help-tag"><a href="#a%3A000">a:000</a></code> <code id="E740" class="help-tag"><a href="#E740">E740</a></code> <code id="..." class="help-tag"><a href="#...">...</a></code>
Up to 20 arguments can be given, separated by commas.  After the named
arguments an argument "..." can be specified, which means that more arguments
may optionally be following.  In the function the extra arguments can be used
as "a:1", "a:2", etc.  "a:0" is set to the number of extra arguments (which
can be 0).  "a:000" is set to a <a href="eval.html#List">List</a> that contains these arguments.  Note
that "a:1" is the same as "a:000[0]".
								<code id="E742" class="help-tag-right"><a href="#E742">E742</a></code>
The a: scope and the variables in it cannot be changed, they are fixed.
However, if a composite type is used, such as <a href="eval.html#List">List</a> or <a href="eval.html#Dictionary">Dictionary</a> , you can
change their contents.  Thus you can pass a <a href="eval.html#List">List</a> to a function and have the
function add an item to it.  If you want to make sure the function cannot
change a <a href="eval.html#List">List</a> or <a href="eval.html#Dictionary">Dictionary</a> use <a href="eval.html#%3Alockvar">:lockvar</a>.</div>
<div class="old-help-para">It is also possible to define a function without any arguments.  You must
still supply the () then.</div>
<div class="old-help-para">It is allowed to define another function inside a function body.</div>
<div class="old-help-para">						<code id="optional-function-argument" class="help-tag-right"><a href="#optional-function-argument">optional-function-argument</a></code>
You can provide default values for positional named arguments.  This makes
them optional for function calls.  When a positional argument is not
specified at a call, the default expression is used to initialize it.
This only works for functions declared with <code>:function</code>, not for
lambda expressions <a href="eval.html#expr-lambda">expr-lambda</a>.</div>
<div class="old-help-para">Example:<pre>function Something(key, value = 10)
   echo a:key .. ": " .. a:value
endfunction
call Something('empty')        "empty: 10"
call Something('key', 20)        "key: 20"</pre>
The argument default expressions are evaluated at the time of the function
call, not when the function is defined.  Thus it is possible to use an
expression which is invalid the moment the function is defined.  The
expressions are also only evaluated when arguments are not specified during a
call.</div>
<div class="old-help-para">								<code id="E989" class="help-tag-right"><a href="#E989">E989</a></code>
Optional arguments with default expressions must occur after any mandatory
arguments.  You can use "..." after all optional named arguments.</div>
<div class="old-help-para">It is possible for later argument defaults to refer to prior arguments,
but not the other way around.  They must be prefixed with "a:", as with all
arguments.</div>
<div class="old-help-para">Example that works:<pre>:function Okay(mandatory, optional = a:mandatory)
:endfunction</pre>
Example that does NOT work:<pre>:function NoGood(first = a:second, second = 10)
:endfunction</pre></div>
<div class="old-help-para">When not using "...", the number of arguments in a function call must be at
least equal to the number of mandatory named arguments.  When using "...", the
number of arguments may be larger than the total of mandatory and optional
arguments.</div>
<div class="old-help-para">							<code id="local-variables" class="help-tag-right"><a href="#local-variables">local-variables</a></code>
Inside a function local variables can be used.  These will disappear when the
function returns. Global variables need to be accessed with "g:". Inside
functions local variables are accessed without prepending anything. But you
can also prepend "l:" if you like.  This is required for some reserved names,
such as "version".</div>
<div class="old-help-para">Example:<pre>:function Table(title, ...)
:  echohl Title
:  echo a:title
:  echohl None
:  echo a:0 .. " items:"
:  for s in a:000
:    echon ' ' .. s
:  endfor
:endfunction</pre>
This function can then be called with:<pre>call Table("Table", "line1", "line2")
call Table("Empty Table")</pre>
To return more than one value, return a <a href="eval.html#List">List</a>:<pre>:function Compute(n1, n2)
:  if a:n2 == 0
:    return ["fail", 0]
:  endif
:  return ["ok", a:n1 / a:n2]
:endfunction</pre>
This function can then be called with:<pre>:let [success, div] = Compute(102, 6)
:if success == "ok"
:  echo div
:endif</pre></div>
<div class="old-help-para"><h2 id="_-" class="help-heading"></h2><div class="help-column_heading">2. Calling a function</div>						<code id="%3Acal" class="help-tag-right"><a href="#%3Acal">:cal</a></code> <code id="%3Acall" class="help-tag"><a href="#%3Acall">:call</a></code> <code id="E107" class="help-tag"><a href="#E107">E107</a></code> <code id="E117" class="help-tag"><a href="#E117">E117</a></code>
:[range]cal[l] <code>{name}</code>([arguments])
		Call a function.  The name of the function and its arguments
		are as specified with <code>:function</code>.  Up to 20 arguments can be
		used.  The returned value is discarded.
		Without a range and for functions that accept a range, the
		function is called once.  When a range is given the cursor is
		positioned at the start of the first line before executing the
		function.
		When a range is given and the function doesn't handle it
		itself, the function is executed for each line in the range,
		with the cursor in the first column of that line.  The cursor
		is left at the last line (possibly moved by the last function
		call).  The arguments are re-evaluated for each line.  Thus
		this works:
						<code id="function-range-example" class="help-tag-right"><a href="#function-range-example">function-range-example</a></code><pre>:function Mynumber(arg)
:  echo line(".") .. " " .. a:arg
:endfunction
:1,5call Mynumber(getline("."))</pre></div>
<div class="old-help-para">		The "a:firstline" and "a:lastline" are defined anyway, they
		can be used to do something different at the start or end of
		the range.</div>
<div class="old-help-para">		Example of a function that handles the range itself:<pre>:function Cont() range
:  execute (a:firstline + 1) .. "," .. a:lastline .. 's/^/\t\\ '
:endfunction
:4,8call Cont()</pre></div>
<div class="old-help-para">		This function inserts the continuation character "\" in front
		of all the lines in the range, except the first one.</div>
<div class="old-help-para">		When the function returns a composite value it can be further
		dereferenced, but the range will not be used then.  Example:<pre>:4,8call GetDict().method()</pre></div>
<div class="old-help-para">		Here GetDict() gets the range but method() does not.</div>
<div class="old-help-para">								<code id="E132" class="help-tag-right"><a href="#E132">E132</a></code>
The recursiveness of user functions is restricted with the <a href="options.html#'maxfuncdepth'">'maxfuncdepth'</a>
option.</div>
<div class="old-help-para">It is also possible to use <code>:eval</code>.  It does not support a range, but does
allow for method chaining, e.g.:<pre>eval GetList()-&gt;Filter()-&gt;append('$')</pre>
A function can also be called as part of evaluating an expression or when it
is used as a method:<pre>let x = GetList()
let y = GetList()-&gt;Filter()</pre></div>
<div class="old-help-para"><h2 id="_-" class="help-heading"></h2><div class="help-column_heading">3. Cleaning up in a function</div>							<code id="%3Adefer" class="help-tag-right"><a href="#%3Adefer">:defer</a></code>
:defer <code>{func}</code>(<code>{args}</code>)	Call <code>{func}</code> when the current function is done.
			<code>{args}</code> are evaluated here.</div>
<div class="old-help-para">Quite often a command in a function has a global effect, which must be undone
when the function finishes.  Handling this in all kinds of situations can be a
hassle.  Especially when an unexpected error is encountered.  This can be done
with <code>try</code> / <code>finally</code> blocks, but this gets complicated when there is more
than one.</div>
<div class="old-help-para">A much simpler solution is using <code>defer</code>.  It schedules a function call when
the function is returning, no matter if there is an error.  Example:<pre>func Filter(text) abort
  call writefile(a:text, 'Tempfile')
  call system('filter &lt; Tempfile &gt; Outfile')
  call Handle('Outfile')
  call delete('Tempfile')
  call delete('Outfile')
endfunc</pre>
Here 'Tempfile' and 'Outfile' will not be deleted if something causes the
function to abort.  <code>:defer</code> can be used to avoid that:<pre>func Filter(text) abort
  call writefile(a:text, 'Tempfile')
  defer delete('Tempfile')
  defer delete('Outfile')
  call system('filter &lt; Tempfile &gt; Outfile')
  call Handle('Outfile')
endfunc</pre>
Note that deleting "Outfile" is scheduled before calling <code>system()</code>, since it
can be created even when <code>system()</code> fails.</div>
<div class="old-help-para">The deferred functions are called in reverse order, the last one added is
executed first.  A useless example:<pre>func Useless() abort
  for s in range(3)
    defer execute('echomsg "number ' .. s .. '"')
  endfor
endfunc</pre>
Now <code>:messages</code> shows:
	number 2
	number 1
	number 0</div>
<div class="old-help-para">Any return value of the deferred function is discarded.  The function cannot
be followed by anything, such as "-&gt;func" or ".member".  Currently:defer
GetArg()-&gt;TheFunc()` does not work, it may work in a later version.</div>
<div class="old-help-para">Errors are reported but do not cause aborting execution of deferred functions.</div>
<div class="old-help-para">No range is accepted.  The function can be a partial with extra arguments, but
not with a dictionary. <code id="E1300" class="help-tag"><a href="#E1300">E1300</a></code></div>
<div class="old-help-para"><h2 id="_-" class="help-heading"></h2><div class="help-column_heading">4. Automatically loading functions</div>							<code id="autoload-functions" class="help-tag-right"><a href="#autoload-functions">autoload-functions</a></code>
When using many or large functions, it's possible to automatically define them
only when they are used.  There are two methods: with an autocommand and with
the "autoload" directory in <a href="options.html#'runtimepath'">'runtimepath'</a>.</div>
<div class="old-help-para"><div class="help-column_heading">Using an autocommand</div></div>
<div class="old-help-para">This is introduced in the user manual, section <a href="usr_41.html#41.14">41.14</a>.</div>
<div class="old-help-para">The autocommand is useful if you have a plugin that is a long Vim script file.
You can define the autocommand and quickly quit the script with <code>:finish</code>.
That makes Vim startup faster.  The autocommand should then load the same file
again, setting a variable to skip the <code>:finish</code> command.</div>
<div class="old-help-para">Use the FuncUndefined autocommand event with a pattern that matches the
function(s) to be defined.  Example:<pre>:au FuncUndefined BufNet* source ~/vim/bufnetfuncs.vim</pre>
The file "~/vim/bufnetfuncs.vim" should then define functions that start with
"BufNet".  Also see <a href="autocmd.html#FuncUndefined">FuncUndefined</a>.</div>
<div class="old-help-para"><div class="help-column_heading">Using an autoload script</div>							<code id="autoload" class="help-tag-right"><a href="#autoload">autoload</a></code> <code id="E746" class="help-tag"><a href="#E746">E746</a></code>
This is introduced in the user manual, section <a href="usr_41.html#41.15">41.15</a>.</div>
<div class="old-help-para">Using a script in the "autoload" directory is simpler, but requires using
exactly the right file name.  A function that can be autoloaded has a name
like this:<pre>:call filename#funcname()</pre>
When such a function is called, and it is not defined yet, Vim will search the
"autoload" directories in <a href="options.html#'runtimepath'">'runtimepath'</a> for a script file called
"filename.vim".  For example "~/.config/nvim/autoload/filename.vim".  That
file should then define the function like this:<pre>function filename#funcname()
   echo "Done!"
endfunction</pre>
If the file doesn't exist, Vim will also search in <a href="options.html#'packpath'">'packpath'</a> (under "start")
to allow calling packages' functions from your <a href="starting.html#vimrc">vimrc</a> when the packages have
not been added to <a href="options.html#'runtimepath'">'runtimepath'</a> yet (see <a href="repeat.html#packages">packages</a>).</div>
<div class="old-help-para">The file name and the name used before the # in the function must match
exactly, and the defined function must have the name exactly as it will be
called.</div>
<div class="old-help-para">It is possible to use subdirectories.  Every # in the function name works like
a path separator.  Thus when calling a function:<pre>:call foo#bar#func()</pre>
Vim will look for the file "autoload/foo/bar.vim" in <a href="options.html#'runtimepath'">'runtimepath'</a>.</div>
<div class="old-help-para">This also works when reading a variable that has not been set yet:<pre>:let l = foo#bar#lvar</pre>
However, when the autoload script was already loaded it won't be loaded again
for an unknown variable.</div>
<div class="old-help-para">When assigning a value to such a variable nothing special happens.  This can
be used to pass settings to the autoload script before it's loaded:<pre>:let foo#bar#toggle = 1
:call foo#bar#func()</pre>
Note that when you make a mistake and call a function that is supposed to be
defined in an autoload script, but the script doesn't actually define the
function, you will get an error message for the missing function.  If you fix
the autoload script it won't be automatically loaded again.  Either restart
Vim or manually source the script.</div>
<div class="old-help-para">Also note that if you have two script files, and one calls a function in the
other and vice versa, before the used function is defined, it won't work.
Avoid using the autoload functionality at the toplevel.</div>
<div class="old-help-para">Hint: If you distribute a bunch of scripts read <a href="usr_41.html#distribute-script">distribute-script</a>.</div>

  </div>
      <div class="col-narrow toc">
      <div><a href="index.html">Main</a></div>
      <div><a href="vimindex.html">Commands index</a></div>
      <div><a href="quickref.html">Quick reference</a></div>
      <hr/>
  <div class="help-toc-h1"><a href="#_-">
</a>
</div><div class="help-toc-h1"><a href="#_-">
</a>
</div><div class="help-toc-h1"><a href="#_-">
</a>
</div><div class="help-toc-h1"><a href="#_-">
</a>
</div></div>
</div>
  <footer>
    <div class="container flex">
      <div class="generator-stats">
        Generated at 2023-09-21 05:26 from <code><a href="https://github.com/neovim/neovim/commit/0aea8fad48ccd891022a5595fc7cdedbe4c04ad3">0aea8fa</a></code>
      </div>
      <div class="generator-stats">
      parse_errors: 0 (<a href="https://github.com/neovim/neovim/issues/new?labels=bug&title=user+docs+HTML%3A+userfunc.txt+&body=%60gen_help_html.lua%60+problem+at%3A+https://neovim.io/doc/user/userfunc.html%0D%0DContext%3A%0D%0D%60%60%60%0DTODO%0D%60%60%60" target="_blank">report docs bug...</a>) | <span title="	Nvim
		  VIM REFERENCE MANUAL	  by Bram Moolenaar
				      Type &lt;a href="various.html#gO"&gt;gO&lt;/a&gt; to see the table of contents.
 vim:tw=78:ts=8:noet:ft=help:norl:">noise_lines: 4</span>
      </div>
    <div>

    <!-- algolia docsearch https://docsearch.algolia.com/docs/docsearch-v3/ -->
    <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
    <script type="module">
      docsearch({
        container: '#docsearch',
        appId: 'X185E15FPG',
        apiKey: 'b5e6b2f9c636b2b471303205e59832ed',
        indexName: 'nvim',
      });
    </script>

  </footer>
  </body>
</html>
