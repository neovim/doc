  <!DOCTYPE html>
  <html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Neovim user documentation">

    <!-- algolia docsearch https://docsearch.algolia.com/docs/docsearch-v3/ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />
    <link rel="preconnect" href="https://X185E15FPG-dsn.algolia.net" crossorigin />

    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/main.css" rel="stylesheet">
    <link href="help.css" rel="stylesheet">
    <link href="/highlight/styles/neovim.min.css" rel="stylesheet">

    <script src="/highlight/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <title> Lua-plugin - Neovim docs</title>
  </head>
  <body>
    <header class="container">
    <nav class="navbar navbar-expand-lg">
      <div class="container-fluid">
        <a href="/" class="navbar-brand" aria-label="logo">
          <!--TODO: use <img src="….svg"> here instead. Need one that has green lettering instead of gray. -->
              <svg xmlns="http://www.w3.org/2000/svg" role="img" width="173" height="50" viewBox="0 0 742 214" aria-label="Neovim">
      <title>Neovim</title>
      <defs>
        <linearGradient x1="50%" y1="0%" x2="50%" y2="100%" id="a">
          <stop stop-color="#16B0ED" stop-opacity=".8" offset="0%" />
          <stop stop-color="#0F59B2" stop-opacity=".837" offset="100%" />
        </linearGradient>
        <linearGradient x1="50%" y1="0%" x2="50%" y2="100%" id="b">
          <stop stop-color="#7DB643" offset="0%" />
          <stop stop-color="#367533" offset="100%" />
        </linearGradient>
        <linearGradient x1="50%" y1="0%" x2="50%" y2="100%" id="c">
          <stop stop-color="#88C649" stop-opacity=".8" offset="0%" />
          <stop stop-color="#439240" stop-opacity=".84" offset="100%" />
        </linearGradient>
      </defs>
      <g fill="none" fill-rule="evenodd">
        <path
          d="M.027 45.459L45.224-.173v212.171L.027 166.894V45.459z"
          fill="url(#a)"
          transform="translate(1 1)"
        />
        <path
          d="M129.337 45.89L175.152-.149l-.928 212.146-45.197-45.104.31-121.005z"
          fill="url(#b)"
          transform="matrix(-1 0 0 1 305 1)"
        />
        <path
          d="M45.194-.137L162.7 179.173l-32.882 32.881L12.25 33.141 45.194-.137z"
          fill="url(#c)"
          transform="translate(1 1)"
        />
        <path
          d="M46.234 84.032l-.063 7.063-36.28-53.563 3.36-3.422 32.983 49.922z"
          fill-opacity=".13"
          fill="#000"
        />
        <g fill="#444">
          <path
            d="M227 154V64.44h4.655c1.55 0 2.445.75 2.685 2.25l.806 13.502c4.058-5.16 8.786-9.316 14.188-12.466 5.4-3.15 11.413-4.726 18.037-4.726 4.893 0 9.205.781 12.935 2.34 3.729 1.561 6.817 3.811 9.264 6.751 2.448 2.942 4.297 6.48 5.55 10.621 1.253 4.14 1.88 8.821 1.88 14.042V154h-8.504V96.754c0-8.402-1.91-14.987-5.729-19.757-3.82-4.771-9.667-7.156-17.544-7.156-5.851 0-11.28 1.516-16.292 4.545-5.013 3.032-9.489 7.187-13.427 12.467V154H227zM350.624 63c5.066 0 9.755.868 14.069 2.605 4.312 1.738 8.052 4.268 11.219 7.592s5.638 7.412 7.419 12.264C385.11 90.313 386 95.883 386 102.17c0 1.318-.195 2.216-.588 2.696-.393.48-1.01.719-1.851.719h-64.966v1.70c0 6.708.784 12.609 2.353 17.7 1.567 5.09 3.8 9.357 6.695 12.802 2.895 3.445 6.393 6.034 10.495 7.771 4.1 1.738 8.686 2.606 13.752 2.606 4.524 0 8.446-.494 11.762-1.483 3.317-.988 6.108-2.097 8.37-3.324 2.261-1.227 4.056-2.336 5.383-3.324 1.326-.988 2.292-1.482 2.895-1.482.784 0 1.388.3 1.81.898l2.352 2.875c-1.448 1.797-3.362 3.475-5.745 5.031-2.383 1.558-5.038 2.891-7.962 3.998-2.926 1.109-6.062 1.991-9.41 2.65a52.21 52.21 0 01-10.088.989c-6.152 0-11.762-1.064-16.828-3.19-5.067-2.125-9.415-5.225-13.043-9.298-3.63-4.074-6.435-9.06-8.415-14.96C310.99 121.655 310 114.9 310 107.294c0-6.408.92-12.323 2.76-17.744 1.84-5.421 4.493-10.093 7.961-14.016 3.467-3.922 7.72-6.991 12.758-9.209C338.513 64.11 344.229 63 350.624 63zm.573 6c-4.696 0-8.904.702-12.623 2.105-3.721 1.404-6.936 3.421-9.65 6.053-2.713 2.631-4.908 5.79-6.586 9.474S319.55 94.439 319 99h60c0-4.679-.672-8.874-2.013-12.588-1.343-3.712-3.232-6.856-5.67-9.43-2.44-2.571-5.367-4.545-8.782-5.92-3.413-1.374-7.192-2.062-11.338-2.062zM435.546 63c6.526 0 12.368 1.093 17.524 3.28 5.154 2.186 9.5 5.286 13.04 9.298 3.538 4.013 6.238 8.85 8.099 14.51 1.861 5.66 2.791 11.994 2.791 19.002 0 7.008-.932 13.327-2.791 18.957-1.861 5.631-4.561 10.452-8.099 14.465-3.54 4.012-7.886 7.097-13.04 9.254-5.156 2.156-10.998 3.234-17.524 3.234-6.529 0-12.369-1.078-17.525-3.234-5.155-2.157-9.517-5.242-13.085-9.254-3.57-4.013-6.285-8.836-8.145-14.465-1.861-5.63-2.791-11.95-2.791-18.957 0-7.008.93-13.342 2.791-19.002 1.861-5.66 4.576-10.496 8.145-14.51 3.568-4.012 7.93-7.112 13.085-9.299C423.177 64.094 429.017 63 435.546 63zm-.501 86c5.341 0 10.006-.918 13.997-2.757 3.99-1.838 7.32-4.474 9.992-7.909 2.67-3.435 4.664-7.576 5.986-12.428 1.317-4.85 1.98-10.288 1.98-16.316 0-5.965-.66-11.389-1.98-16.27-1.322-4.88-3.316-9.053-5.986-12.519-2.67-3.463-6-6.13-9.992-7.999-3.991-1.867-8.657-2.802-13.997-2.802s-10.008.935-13.997 2.802c-3.991 1.87-7.322 4.536-9.992 8-2.671 3.465-4.68 7.637-6.03 12.518-1.35 4.881-2.026 10.305-2.026 16.27 0 6.026.675 11.465 2.025 16.316 1.35 4.852 3.36 8.993 6.031 12.428 2.67 3.435 6 6.07 9.992 7.91 3.99 1.838 8.656 2.756 13.997 2.756z"
            fill="currentColor"
          />
          <path
            d="M530.57 152h-20.05L474 60h18.35c1.61 0 2.967.39 4.072 1.166 1.103.778 1.865 1.763 2.283 2.959l17.722 49.138a92.762 92.762 0 012.551 8.429c.686 2.751 1.298 5.5 1.835 8.25.537-2.75 1.148-5.499 1.835-8.25a77.713 77.713 0 012.64-8.429l18.171-49.138c.417-1.196 1.164-2.181 2.238-2.96 1.074-.776 2.356-1.165 3.849-1.165H567l-36.43 92zM572 61h23v92h-23zM610 153V60.443h13.624c2.887 0 4.78 1.354 5.682 4.06l1.443 6.856a52.7 52.7 0 015.097-4.962 32.732 32.732 0 015.683-3.879 30.731 30.731 0 016.496-2.57c2.314-.632 4.855-.948 7.624-.948 5.832 0 10.63 1.579 14.39 4.736 3.758 3.157 6.57 7.352 8.434 12.585 1.444-3.068 3.248-5.698 5.413-7.894 2.165-2.194 4.541-3.984 7.127-5.367a32.848 32.848 0 018.254-3.068 39.597 39.597 0 018.796-.992c5.111 0 9.653.783 13.622 2.345 3.97 1.565 7.307 3.849 10.014 6.857 2.706 3.007 4.766 6.675 6.18 11.005C739.29 83.537 740 88.5 740 94.092V153h-22.284V94.092c0-5.894-1.294-10.329-3.878-13.306-2.587-2.977-6.376-4.465-11.368-4.465-2.286 0-4.404.391-6.358 1.172a15.189 15.189 0 00-5.144 3.383c-1.473 1.474-2.631 3.324-3.474 5.548-.842 2.225-1.263 4.781-1.263 7.668V153h-22.37V94.092c0-6.194-1.249-10.704-3.744-13.532-2.497-2.825-6.18-4.24-11.051-4.24-3.19 0-6.18.798-8.976 2.391-2.799 1.593-5.399 3.775-7.804 6.54V153H610zM572 30h23v19h-23z"
            fill="currentColor"
            fill-opacity=".8"
          />
        </g>
      </g>
    </svg>
  
          <!--<img src="https://neovim.io/logos/neovim-logo.svg" width="173" height="50" alt="Neovim" />-->
        </a>
        <div id="docsearch"></div> <!-- algolia docsearch https://docsearch.algolia.com/docs/docsearch-v3/ -->
      </div>
    </nav>
  </header>

  <div class="container golden-grid help-body">
  <div class="col-wide">
  <a name="lua-plugin.txt" href="#lua-plugin"><h1 id="lua-plugin"> Lua-plugin</h1></a>
  <p>
    <i>
    Nvim <code>:help</code> pages, <a href="https://github.com/neovim/neovim/blob/master/src/gen/gen_help_html.lua">generated</a>
    from <a href="https://github.com/neovim/neovim/blob/master/runtime/doc/lua-plugin.txt">source</a>
    using the <a href="https://github.com/neovim/tree-sitter-vimdoc">tree-sitter-vimdoc</a> parser.
    </i>
  </p>
  <hr/>
  <div class="help-para">
                   Guide to developing Lua plugins for Nvim

</div>
<div class="help-para">
<h2 id="_introduction" class="help-heading">Introduction</h2>


</div>
<div class="help-para">
This document provides guidance for developing Nvim Lua plugins.

</div>
<div class="help-para">
See <a href="lua-guide.html#lua-guide">lua-guide</a> for guidance on using Lua to configure and operate Nvim.
See <a href="luaref.html#luaref">luaref</a> and <a href="lua.html#lua-concepts">lua-concepts</a> for details on the Lua programming language.

</div>
<div class="help-para">
<h2 id="_creating-your-first-plugin" class="help-heading">Creating your first plugin<span class="help-heading-tags">                                    <span id="lua-plugin-new" class="help-tag"><a href="#lua-plugin-new">lua-plugin-new</a></span></h2>


</div>
<div class="help-para">
Any Vimscript or Lua code file that lives in the right directory,
automatically is a "plugin". There's no manifest or "registration" step.

</div>
<div class="help-para">
You can try it right now:

</div>
<div class="help-para">
<div class="help-li-num" style=""> Visit your config directory:
<pre>:exe 'edit' stdpath('config')</pre></div><div class="help-li-num" style=""> Create a <code>plugin/foo.lua</code> file in there.
</div><div class="help-li-num" style=""> Add something to it, like:
<pre><code class="language-lua">vim.print('Hello World')</code></pre></div><div class="help-li-num" style=""> Start <code>nvim</code> and notice that it prints "Hello World" in the messages area.
   Check <code>:messages</code> if you don't see it.
</div>
</div>
<div class="help-para">
Besides <code>plugin/foo.lua</code>, which is always run at startup, you can define Lua
modules in the <code>lua/</code> directory. Those modules aren't loaded until your
<code>plugin/foo.lua</code>, or the user, calls <code>require(…)</code>.

</div>
<div class="help-para">
<h2 id="_type-safety" class="help-heading">Type safety<span class="help-heading-tags">                                            <span id="lua-plugin-type-safety" class="help-tag"><a href="#lua-plugin-type-safety">lua-plugin-type-safety</a></span></h2>


</div>
<div class="help-para">
Lua, as a dynamically typed language, is great for configuration. It provides
virtually immediate feedback.
But for larger projects, this can be a double-edged sword, leaving your plugin
susceptible to unexpected bugs at the wrong time.

</div>
<div class="help-para">
You can leverage LuaCATS or "emmylua" annotations <a href="https://luals.github.io/wiki/annotations/">https://luals.github.io/wiki/annotations/</a>
along with lua-language-server ("LuaLS") <a href="https://luals.github.io/">https://luals.github.io/</a> to catch
potential bugs in your CI before your plugin's users do. The Nvim codebase
uses these annotations extensively.

</div>
<div class="help-para">
<h3 id="_tools" class="help-heading">TOOLS</h3>


</div>
<div class="help-para">
<div class="help-li" style=""> lua-typecheck-action <a href="https://github.com/marketplace/actions/lua-typecheck-action">https://github.com/marketplace/actions/lua-typecheck-action</a>
</div><div class="help-li" style=""> lua-language-server <a href="https://luals.github.io">https://luals.github.io</a>
</div>
</div>
<div class="help-para">
<h2 id="_keymaps" class="help-heading">Keymaps<span class="help-heading-tags">                                                   <span id="lua-plugin-keymaps" class="help-tag"><a href="#lua-plugin-keymaps">lua-plugin-keymaps</a></span></h2>


</div>
<div class="help-para">
Avoid creating excessive keymaps automatically. Doing so can conflict with
user <a href="map.html#mapping">mapping</a>s.

</div>
<div class="help-para">
<b>NOTE:</b> An example for uncontroversial keymaps are buffer-local <a href="map.html#mapping">mapping</a>s for
      specific file types or floating windows, or <code>&lt;Plug&gt;</code> mappings.

</div>
<div class="help-para">
A common approach to allow keymap configuration is to define a declarative DSL
<a href="https://en.wikipedia.org/wiki/Domain-specific_language">https://en.wikipedia.org/wiki/Domain-specific_language</a> via a <code>setup</code> function.

</div>
<div class="help-para">
However, doing so means that

</div>
<div class="help-para">
<div class="help-li" style=""> You will have to implement and document it yourself.
</div><div class="help-li" style=""> Users will likely face inconsistencies if another plugin has a slightly
  different DSL.
</div><div class="help-li" style=""> <a href="starting.html#init.lua">init.lua</a> scripts that call such a <code>setup</code> function may throw an error if
  the plugin is not installed or disabled.
</div>
</div>
<div class="help-para">
As an alternative, you can provide <a href="map.html#%3CPlug%3E">&lt;Plug&gt;</a> mappings to allow users to define
their own keymaps with <a href="lua.html#vim.keymap.set()">vim.keymap.set()</a>.

</div>
<div class="help-para">
<div class="help-li" style=""> This requires one line of code in user configs.
</div><div class="help-li" style=""> Even if your plugin is not installed or disabled, creating the keymap won't
  throw an error.
</div>
</div>
<div class="help-para">
Another option is to simply expose a Lua function or <a href="map.html#user-commands">user-commands</a>.

</div>
<div class="help-para">
Some benefits of <a href="map.html#%3CPlug%3E">&lt;Plug&gt;</a> mappings are that you can

</div>
<div class="help-para">
<div class="help-li" style=""> Enforce options like <code>expr = true</code>.
</div><div class="help-li" style=""> Use <a href="lua.html#vim.keymap">vim.keymap</a>'s built-in mode handling to expose functionality only for
  specific <a href="map.html#map-modes">map-modes</a>.
</div><div class="help-li" style=""> Handle different <a href="map.html#map-modes">map-modes</a> differently with a single mapping, without
  adding mode checks to the underlying implementation.
</div><div class="help-li" style=""> Detect user-defined mappings through <a href="vimfn.html#hasmapto()">hasmapto()</a> before creating defaults.
</div>
</div>
<div class="help-para">
Some benefits of exposing a Lua function are:

</div>
<div class="help-para">
<div class="help-li" style=""> Extensibility, if the function takes an options table as an argument.
</div><div class="help-li" style=""> A cleaner UX, if there are many options and enumerating all combinations
  of options would result in a lot of <a href="map.html#%3CPlug%3E">&lt;Plug&gt;</a> mappings.
</div>
</div>
<div class="help-para">
<b>NOTE:</b> If your function takes an options table, users may still benefit
      from <a href="map.html#%3CPlug%3E">&lt;Plug&gt;</a> mappings for the most common combinations.

</div>
<div class="help-para">
<h3 id="_keymap-example" class="help-heading">KEYMAP EXAMPLE</h3>


</div>
<div class="help-para">
In your plugin:
<pre><code class="language-lua">vim.keymap.set('n', '&lt;Plug&gt;(SayHello)', function()
    print('Hello from normal mode')
end)
vim.keymap.set('v', '&lt;Plug&gt;(SayHello)', function()
    print('Hello from visual mode')
end)</code></pre>

</div>
<div class="help-para">
In the user's config:
<pre><code class="language-lua">vim.keymap.set({'n', 'v'}, '&lt;leader&gt;h', '&lt;Plug&gt;(SayHello)')</code></pre>

</div>
<div class="help-para">
<h2 id="_initialization" class="help-heading">Initialization<span class="help-heading-tags">                                               <span id="lua-plugin-init" class="help-tag"><a href="#lua-plugin-init">lua-plugin-init</a></span></h2>


</div>
<div class="help-para">
Strictly separated configuration and smart initialization allow your plugin to
work out of the box. Common approaches are:

</div>
<div class="help-para">
<div class="help-li" style=""> A Lua function, e.g. <code>setup(opts)</code> or <code>configure(opts)</code>, which only overrides the
  default configuration and does not contain any initialization logic.
</div><div class="help-li" style=""> A Vimscript compatible table (e.g. in the <a href="lua.html#vim.g">vim.g</a> or <a href="lua.html#vim.b">vim.b</a> namespace) that your
  plugin reads from and validates at initialization time.
  See also <a href="lua.html#lua-vim-variables">lua-vim-variables</a>.
</div>
</div>
<div class="help-para">
Typically, automatic initialization logic is done in a <a href="usr_05.html#plugin">plugin</a> or <a href="usr_41.html#ftplugin">ftplugin</a>
script. See also <a href="options.html#'runtimepath'">'runtimepath'</a>.

</div>
<div class="help-para">
On the other hand, a single <code>setup(opts)</code> that combines configuration and
initialization may be useful in specific cases:

</div>
<div class="help-para">
<div class="help-li" style=""> Customizing complex initialization, where there is a significant risk of
  misconfiguration.
</div><div class="help-li" style=""> Requiring users to opt in for plugin functionality that should not be
  initialized automatically.
</div>
</div>
<div class="help-para">
Keep in mind that this approach requires users to call <code>setup</code> in order to
use your plugin, even if the default configuration is enough for them.
Consider carefully whether your plugin benefits from combined <code>setup()</code> pattern
before adopting it.

</div>
<div class="help-para">
<b>NOTE:</b> A well designed plugin has minimal impact on startup time. See also
<a href="lua-plugin.html#lua-plugin-lazy">lua-plugin-lazy</a>.

</div>
<div class="help-para">
<h2 id="_lazy-loading" class="help-heading">Lazy loading<span class="help-heading-tags">                                                 <span id="lua-plugin-lazy" class="help-tag"><a href="#lua-plugin-lazy">lua-plugin-lazy</a></span></h2>


</div>
<div class="help-para">
Some users like to micro-manage "lazy loading" of plugins by explicitly
configuring which commands and key mappings load the plugin.

</div>
<div class="help-para">
Your plugin should not depend on every user micro-managing their configuration
in such a way. Nvim has a mechanism for every plugin to do its own implicit
lazy-loading (in Vimscript it's called <a href="userfunc.html#autoload">autoload</a>), via <code>autoload/</code>
(Vimscript) and <code>lua/</code> (Lua). Plugin authors can provide "lazy loading" by
providing a <code>plugin/&lt;name&gt;.lua</code> file which defines their commands and
keymappings. This file should be small, and should not eagerly <code>require()</code> the
rest of your plugin. Commands and mappings should do the <code>require()</code>.

</div>
<div class="help-para">
Guidance:

</div>
<div class="help-para">
<div class="help-li" style=""> Plugins should arrange their "lazy" behavior once, instead of expecting every user to micromanage it.
</div><div class="help-li" style=""> Keep <code>plugin/&lt;name&gt;.lua</code> small, avoid eagerly calling <code>require()</code> on modules
  until a command or mapping is actually used.
</div>
</div>
<div class="help-para">
<h3 id="_defer-require()-calls" class="help-heading">Defer require() calls<span class="help-heading-tags">                               <span id="lua-plugin-defer-require" class="help-tag"><a href="#lua-plugin-defer-require">lua-plugin-defer-require</a></span></h3>


</div>
<div class="help-para">
<code>plugin/&lt;name&gt;.lua</code> scripts (<a href="usr_05.html#plugin">plugin</a>) are eagerly run at startup; this is
intentional, so that plugins can setup the (minimal) commands and keymappings
that users will use to invoke the plugin. This also means these "plugin/"
files should NOT eagerly <code>require</code> Lua modules.

</div>
<div class="help-para">
For example, instead of:
<pre><code class="language-lua">local foo = require('foo')
vim.api.nvim_create_user_command('MyCommand', function()
    foo.do_something()
end, {
  -- ...
})</code></pre>

</div>
<div class="help-para">
which calls <code>require('foo')</code> as soon as the module is loaded, you can
lazy-load it by moving the <code>require</code> into the command's implementation:
<pre><code class="language-lua">vim.api.nvim_create_user_command('MyCommand', function()
    local foo = require('foo')
    foo.do_something()
end, {
  -- ...
})</code></pre>

</div>
<div class="help-para">
Likewise, if a plugin uses a Lua module as an entrypoint, it should
defer <code>require</code> calls too.

</div>
<div class="help-para">
<b>NOTE:</b> For a Vimscript alternative to <code>require</code>, see <a href="userfunc.html#autoload">autoload</a>.

</div>
<div class="help-para">
<b>NOTE:</b> If you are worried about eagerly creating user commands, autocommands or
keymaps at startup: Plugin managers that provide abstractions for lazy-loading
plugins on such events do the same amount of work. There is no performance
benefit for users to define lazy-loading entrypoints in their configuration
instead of plugins defining it in <code>plugin/&lt;name&gt;.lua</code>.

</div>
<div class="help-para">
<b>NOTE:</b> You can use <a href="starting.html#--startuptime">--startuptime</a> to <a href="repeat.html#profile">profile</a> the impact a plugin has on
startup time.

</div>
<div class="help-para">
<h3 id="_filetype-specific-functionality" class="help-heading">Filetype-specific functionality<span class="help-heading-tags">                          <span id="lua-plugin-filetype" class="help-tag"><a href="#lua-plugin-filetype">lua-plugin-filetype</a></span></h3>


</div>
<div class="help-para">
Consider making use of <a href="options.html#'filetype'">'filetype'</a> for any functionality that is specific to
a filetype, by putting the initialization logic in a <code>ftplugin/{filetype}.lua</code>
script.

</div>
<div class="help-para">
For buffers owned by your plugin (often used to show a custom UI or view),
typically your plugin will set a custom <a href="options.html#'filetype'">'filetype'</a>. In that case, it's useful
to set the <a href="options.html#'filetype'">'filetype'</a> "as late as possible", so that users can override
buffer-local settings after your plugin has (re)initialized the buffer.

</div>
<div class="help-para">
<h3 id="_filetype-example" class="help-heading">FILETYPE EXAMPLE</h3>


</div>
<div class="help-para">
A plugin tailored to Rust development might have initialization in
<code>ftplugin/rust.lua</code>:
<pre><code class="language-lua">if not vim.g.loaded_my_rust_plugin then
    -- Initialize
end
-- NOTE: Using `vim.g.loaded_` prevents the plugin from initializing twice
-- and allows users to prevent plugins from loading
-- (in both Lua and Vimscript).
vim.g.loaded_my_rust_plugin = true
local bufnr = vim.api.nvim_get_current_buf()
-- do something specific to this buffer,
-- e.g. add a |&lt;Plug&gt;| mapping or create a command
vim.keymap.set('n', '&lt;Plug&gt;(MyPluginBufferAction)', function()
    print('Hello')
end, { buffer = bufnr, })</code></pre>

</div>
<div class="help-para">
<h2 id="_configuration" class="help-heading">Configuration<span class="help-heading-tags">                                              <span id="lua-plugin-config" class="help-tag"><a href="#lua-plugin-config">lua-plugin-config</a></span></h2>


</div>
<div class="help-para">
To allow users to override buffer-local configuration for filetypes owned by
your plugin, publish a <a href="autocmd.html#FileType">FileType</a> event, "as late as possible".
<a href="lua-plugin.html#lua-plugin-filetype">lua-plugin-filetype</a>

</div>
<div class="help-para">
Once you have merged the default configuration with the user's config, you
should validate configs.

</div>
<div class="help-para">
Validations could include:

</div>
<div class="help-para">
<div class="help-li" style=""> Correct types, see <a href="lua.html#vim.validate()">vim.validate()</a>
</div><div class="help-li" style=""> Unknown fields in the user config (e.g. due to typos).
  This can be tricky to implement, and may be better suited for a <a href="health.html#health">health</a>
  check, to reduce overhead.
</div>
</div>
<div class="help-para">
<h2 id="_ui" class="help-heading">UI<span class="help-heading-tags">                                                           <span id="lua-plugin-ui" class="help-tag"><a href="#lua-plugin-ui">lua-plugin-ui</a></span></h2>


</div>
<div class="help-para">
Some plugins have their own "UI" which they present in a buffer that the
plugin "owns". In that buffer typically you will want to provide custom
actions.

</div>
<div class="help-para">
Besides creating <a href="map.html#%3CPlug%3E">&lt;Plug&gt;</a> mappings, you may want to consider providing actions
by defining an in-process LSP server. Offering actions as code-actions
<a href="lsp.html#vim.lsp.buf.code_action()">vim.lsp.buf.code_action()</a> means the user can see all available actions using
the default <a href="lsp.html#gra">gra</a> mapping to view the code-actions menu. They can even define
mappings to a specific action by invoking <code>vim.lsp.buf.code_action()</code> with the
<code>filter</code> + <code>apply</code> parameters:<pre><code class="language-lua">vim.lsp.buf.code_action({
    apply = true,
    filter = function(a)
        return a.title == 'Do something'
    end,
})</code></pre>

</div>
<div class="help-para">
Example: See <code>runtime/lua/vim/pack/_lsp.lua</code> for how vim.pack defines an
in-process LSP server to provide interactive features in its
<code>nvim-pack://confirm</code> buffer.

</div>
<div class="help-para">
<h2 id="_troubleshooting" class="help-heading">Troubleshooting<span class="help-heading-tags">                                   <span id="lua-plugin-troubleshooting" class="help-tag"><a href="#lua-plugin-troubleshooting">lua-plugin-troubleshooting</a></span></h2>


</div>
<div class="help-para">
While developing a plugin, you can use the <a href="gui.html#%3Arestart">:restart</a> command to see the
result of code changes in your plugin.

</div>
<div class="help-para">
<h3 id="_health" class="help-heading">HEALTH</h3>


</div>
<div class="help-para">
Nvim's "health" framework gives plugins a simple way to report status checks
to users. See <a href="health.html#health-dev">health-dev</a> for an example.

</div>
<div class="help-para">
Basically, this just means your plugin will have a <code>lua/{plugin}/health.lua</code>
file. <a href="health.html#%3Acheckhealth">:checkhealth</a> will automatically find this file when it runs.

</div>
<div class="help-para">
Some things to validate:

</div>
<div class="help-para">
<div class="help-li" style=""> User configuration
</div><div class="help-li" style=""> Proper initialization
</div><div class="help-li" style=""> Presence of Lua dependencies (e.g. other plugins)
</div><div class="help-li" style=""> Presence of external dependencies
</div>
</div>
<div class="help-para">
<h3 id="_minimal-config-template" class="help-heading">MINIMAL CONFIG TEMPLATE</h3>


</div>
<div class="help-para">
It can be useful to provide a template for a minimal configuration, along with
a guide on how to use it to reproduce issues.

</div>
<div class="help-para">
<h2 id="_versioning-and-releases" class="help-heading">Versioning and releases<span class="help-heading-tags">                                <span id="lua-plugin-versioning" class="help-tag"><a href="#lua-plugin-versioning">lua-plugin-versioning</a></span></h2>


</div>
<div class="help-para">
Consider:

</div>
<div class="help-para">
<div class="help-li" style=""> Use <a href="lua.html#vim.deprecate()">vim.deprecate()</a> or a <code>---@deprecate</code> annotation when you need to
  communicate a (future) breaking change or discouraged practice.
</div><div class="help-li" style=""> Using SemVer <a href="https://semver.org/">https://semver.org/</a> tags and releases to properly communicate
  bug fixes, new features, and breaking changes.
</div><div class="help-li" style=""> Automating versioning and releases in CI.
</div><div class="help-li" style=""> Publishing to luarocks <a href="https://luarocks.org">https://luarocks.org</a>, especially if your plugin
  has dependencies or components that need to be built; or if it could be a
  dependency for another plugin.
</div>
</div>
<div class="help-para">
<h3 id="_further-reading" class="help-heading">FURTHER READING</h3>


</div>
<div class="help-para">
<div class="help-li" style=""> Luarocks ❤️ Nvim <a href="https://github.com/nvim-neorocks/sample-luarocks-plugin">https://github.com/nvim-neorocks/sample-luarocks-plugin</a>
</div>
</div>
<div class="help-para">
<h3 id="_versioning-tools" class="help-heading">VERSIONING TOOLS</h3>


</div>
<div class="help-para">
<div class="help-li" style=""> luarocks-tag-release
  <a href="https://github.com/marketplace/actions/luarocks-tag-release">https://github.com/marketplace/actions/luarocks-tag-release</a>
</div><div class="help-li" style=""> release-please-action
  <a href="https://github.com/marketplace/actions/release-please-action">https://github.com/marketplace/actions/release-please-action</a>
</div><div class="help-li" style=""> semantic-release
  <a href="https://github.com/semantic-release/semantic-release">https://github.com/semantic-release/semantic-release</a>
</div>
</div>
<div class="help-para">
<h2 id="_documentation" class="help-heading">Documentation<span class="help-heading-tags">                                                 <span id="lua-plugin-doc" class="help-tag"><a href="#lua-plugin-doc">lua-plugin-doc</a></span></h2>


</div>
<div class="help-para">
Provide vimdoc (see <a href="helphelp.html#help-writing">help-writing</a>), so that users can read your plugin's
documentation in Nvim, by entering <code>:h {plugin}</code> in <a href="intro.html#command-mode">command-mode</a>. The
help-tags (the right-aligned "search keywords" in the help documents) are
regenerated using the <a href="helphelp.html#%3Ahelptags">:helptags</a> command.

</div>
<div class="help-para">
<h3 id="_documentation-tools" class="help-heading">DOCUMENTATION TOOLS</h3>


</div>
<div class="help-para">
<div class="help-li" style=""> panvimdoc <a href="https://github.com/kdheepak/panvimdoc">https://github.com/kdheepak/panvimdoc</a>
</div>
</div>

  </div>
      <div class="col-narrow toc">
      <div><a href="index.html">Main</a></div>
      <div><a href="vimindex.html">Commands index</a></div>
      <div><a href="quickref.html">Quick reference</a></div>
      <hr/>
  <div class="help-toc-h1"><a href="#_introduction">Introduction</a>
</div><div class="help-toc-h1"><a href="#_creating-your-first-plugin">Creating your first plugin</a>
</div><div class="help-toc-h1"><a href="#_type-safety">Type safety</a>
<div class="help-toc-h2"><a href="#_tools">TOOLS</a></div>
</div><div class="help-toc-h1"><a href="#_keymaps">Keymaps</a>
<div class="help-toc-h2"><a href="#_keymap-example">KEYMAP EXAMPLE</a></div>
</div><div class="help-toc-h1"><a href="#_initialization">Initialization</a>
</div><div class="help-toc-h1"><a href="#_lazy-loading">Lazy loading</a>
<div class="help-toc-h2"><a href="#_defer-require()-calls">Defer require() calls</a></div>
<div class="help-toc-h2"><a href="#_filetype-specific-functionality">Filetype-specific functionality</a></div>
<div class="help-toc-h2"><a href="#_filetype-example">FILETYPE EXAMPLE</a></div>
</div><div class="help-toc-h1"><a href="#_configuration">Configuration</a>
</div><div class="help-toc-h1"><a href="#_ui">UI</a>
</div><div class="help-toc-h1"><a href="#_troubleshooting">Troubleshooting</a>
<div class="help-toc-h2"><a href="#_health">HEALTH</a></div>
<div class="help-toc-h2"><a href="#_minimal-config-template">MINIMAL CONFIG TEMPLATE</a></div>
</div><div class="help-toc-h1"><a href="#_versioning-and-releases">Versioning and releases</a>
<div class="help-toc-h2"><a href="#_further-reading">FURTHER READING</a></div>
<div class="help-toc-h2"><a href="#_versioning-tools">VERSIONING TOOLS</a></div>
</div><div class="help-toc-h1"><a href="#_documentation">Documentation</a>
<div class="help-toc-h2"><a href="#_documentation-tools">DOCUMENTATION TOOLS</a></div>
</div></div>
</div>
  <footer>
    <div class="container flex">
      <div class="generator-stats">
        Generated at 2026-02-04 05:53 from <code><a href="https://github.com/neovim/neovim/commit/ddd1bf757fab3615301053acab5cc85508340844">ddd1bf7</a></code>
      </div>
      <div class="generator-stats">
      parse_errors: 0 (<a href="https://github.com/neovim/neovim/issues/new?labels=bug&title=user+docs+HTML%3A+lua-plugin.txt+&body=%60gen_help_html.lua%60+problem+at%3A+https://neovim.io/doc/user/lua-plugin.html%0D%0DContext%3A%0D%0D%60%60%60%0DTODO%0D%60%60%60" target="_blank">report docs bug...</a>) | <span title="                     Nvim
                            NVIM REFERENCE MANUAL
                                       Type &lt;a href="various.html#gO"&gt;gO&lt;/a&gt; to see the table of contents.">noise_lines: 3</span>
      </div>
    <div>

    <!-- algolia docsearch https://docsearch.algolia.com/docs/docsearch-v3/ -->
    <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
    <script type="module">
      docsearch({
        container: '#docsearch',
        appId: 'X185E15FPG',
        apiKey: 'b5e6b2f9c636b2b471303205e59832ed',
        indexName: 'nvim',
      });
    </script>

  </footer>
  </body>
</html>
