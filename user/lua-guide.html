  <!DOCTYPE html>
  <html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Neovim user documentation">

    <!-- algolia docsearch https://docsearch.algolia.com/docs/docsearch-v3/ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />
    <link rel="preconnect" href="https://X185E15FPG-dsn.algolia.net" crossorigin />

    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/main.css" rel="stylesheet">
    <link href="help.css" rel="stylesheet">
    <link href="/highlight/styles/neovim.min.css" rel="stylesheet">

    <script src="/highlight/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <title> Lua-guide - Neovim docs</title>
  </head>
  <body>
    <header class="container">
    <nav class="navbar navbar-expand-lg">
      <div class="container-fluid">
        <a href="/" class="navbar-brand" aria-label="logo">
          <!--TODO: use <img src="â€¦.svg"> here instead. Need one that has green lettering instead of gray. -->
              <svg xmlns="http://www.w3.org/2000/svg" role="img" width="173" height="50" viewBox="0 0 742 214" aria-label="Neovim">
      <title>Neovim</title>
      <defs>
        <linearGradient x1="50%" y1="0%" x2="50%" y2="100%" id="a">
          <stop stop-color="#16B0ED" stop-opacity=".8" offset="0%" />
          <stop stop-color="#0F59B2" stop-opacity=".837" offset="100%" />
        </linearGradient>
        <linearGradient x1="50%" y1="0%" x2="50%" y2="100%" id="b">
          <stop stop-color="#7DB643" offset="0%" />
          <stop stop-color="#367533" offset="100%" />
        </linearGradient>
        <linearGradient x1="50%" y1="0%" x2="50%" y2="100%" id="c">
          <stop stop-color="#88C649" stop-opacity=".8" offset="0%" />
          <stop stop-color="#439240" stop-opacity=".84" offset="100%" />
        </linearGradient>
      </defs>
      <g fill="none" fill-rule="evenodd">
        <path
          d="M.027 45.459L45.224-.173v212.171L.027 166.894V45.459z"
          fill="url(#a)"
          transform="translate(1 1)"
        />
        <path
          d="M129.337 45.89L175.152-.149l-.928 212.146-45.197-45.104.31-121.005z"
          fill="url(#b)"
          transform="matrix(-1 0 0 1 305 1)"
        />
        <path
          d="M45.194-.137L162.7 179.173l-32.882 32.881L12.25 33.141 45.194-.137z"
          fill="url(#c)"
          transform="translate(1 1)"
        />
        <path
          d="M46.234 84.032l-.063 7.063-36.28-53.563 3.36-3.422 32.983 49.922z"
          fill-opacity=".13"
          fill="#000"
        />
        <g fill="#444">
          <path
            d="M227 154V64.44h4.655c1.55 0 2.445.75 2.685 2.25l.806 13.502c4.058-5.16 8.786-9.316 14.188-12.466 5.4-3.15 11.413-4.726 18.037-4.726 4.893 0 9.205.781 12.935 2.34 3.729 1.561 6.817 3.811 9.264 6.751 2.448 2.942 4.297 6.48 5.55 10.621 1.253 4.14 1.88 8.821 1.88 14.042V154h-8.504V96.754c0-8.402-1.91-14.987-5.729-19.757-3.82-4.771-9.667-7.156-17.544-7.156-5.851 0-11.28 1.516-16.292 4.545-5.013 3.032-9.489 7.187-13.427 12.467V154H227zM350.624 63c5.066 0 9.755.868 14.069 2.605 4.312 1.738 8.052 4.268 11.219 7.592s5.638 7.412 7.419 12.264C385.11 90.313 386 95.883 386 102.17c0 1.318-.195 2.216-.588 2.696-.393.48-1.01.719-1.851.719h-64.966v1.70c0 6.708.784 12.609 2.353 17.7 1.567 5.09 3.8 9.357 6.695 12.802 2.895 3.445 6.393 6.034 10.495 7.771 4.1 1.738 8.686 2.606 13.752 2.606 4.524 0 8.446-.494 11.762-1.483 3.317-.988 6.108-2.097 8.37-3.324 2.261-1.227 4.056-2.336 5.383-3.324 1.326-.988 2.292-1.482 2.895-1.482.784 0 1.388.3 1.81.898l2.352 2.875c-1.448 1.797-3.362 3.475-5.745 5.031-2.383 1.558-5.038 2.891-7.962 3.998-2.926 1.109-6.062 1.991-9.41 2.65a52.21 52.21 0 01-10.088.989c-6.152 0-11.762-1.064-16.828-3.19-5.067-2.125-9.415-5.225-13.043-9.298-3.63-4.074-6.435-9.06-8.415-14.96C310.99 121.655 310 114.9 310 107.294c0-6.408.92-12.323 2.76-17.744 1.84-5.421 4.493-10.093 7.961-14.016 3.467-3.922 7.72-6.991 12.758-9.209C338.513 64.11 344.229 63 350.624 63zm.573 6c-4.696 0-8.904.702-12.623 2.105-3.721 1.404-6.936 3.421-9.65 6.053-2.713 2.631-4.908 5.79-6.586 9.474S319.55 94.439 319 99h60c0-4.679-.672-8.874-2.013-12.588-1.343-3.712-3.232-6.856-5.67-9.43-2.44-2.571-5.367-4.545-8.782-5.92-3.413-1.374-7.192-2.062-11.338-2.062zM435.546 63c6.526 0 12.368 1.093 17.524 3.28 5.154 2.186 9.5 5.286 13.04 9.298 3.538 4.013 6.238 8.85 8.099 14.51 1.861 5.66 2.791 11.994 2.791 19.002 0 7.008-.932 13.327-2.791 18.957-1.861 5.631-4.561 10.452-8.099 14.465-3.54 4.012-7.886 7.097-13.04 9.254-5.156 2.156-10.998 3.234-17.524 3.234-6.529 0-12.369-1.078-17.525-3.234-5.155-2.157-9.517-5.242-13.085-9.254-3.57-4.013-6.285-8.836-8.145-14.465-1.861-5.63-2.791-11.95-2.791-18.957 0-7.008.93-13.342 2.791-19.002 1.861-5.66 4.576-10.496 8.145-14.51 3.568-4.012 7.93-7.112 13.085-9.299C423.177 64.094 429.017 63 435.546 63zm-.501 86c5.341 0 10.006-.918 13.997-2.757 3.99-1.838 7.32-4.474 9.992-7.909 2.67-3.435 4.664-7.576 5.986-12.428 1.317-4.85 1.98-10.288 1.98-16.316 0-5.965-.66-11.389-1.98-16.27-1.322-4.88-3.316-9.053-5.986-12.519-2.67-3.463-6-6.13-9.992-7.999-3.991-1.867-8.657-2.802-13.997-2.802s-10.008.935-13.997 2.802c-3.991 1.87-7.322 4.536-9.992 8-2.671 3.465-4.68 7.637-6.03 12.518-1.35 4.881-2.026 10.305-2.026 16.27 0 6.026.675 11.465 2.025 16.316 1.35 4.852 3.36 8.993 6.031 12.428 2.67 3.435 6 6.07 9.992 7.91 3.99 1.838 8.656 2.756 13.997 2.756z"
            fill="currentColor"
          />
          <path
            d="M530.57 152h-20.05L474 60h18.35c1.61 0 2.967.39 4.072 1.166 1.103.778 1.865 1.763 2.283 2.959l17.722 49.138a92.762 92.762 0 012.551 8.429c.686 2.751 1.298 5.5 1.835 8.25.537-2.75 1.148-5.499 1.835-8.25a77.713 77.713 0 012.64-8.429l18.171-49.138c.417-1.196 1.164-2.181 2.238-2.96 1.074-.776 2.356-1.165 3.849-1.165H567l-36.43 92zM572 61h23v92h-23zM610 153V60.443h13.624c2.887 0 4.78 1.354 5.682 4.06l1.443 6.856a52.7 52.7 0 015.097-4.962 32.732 32.732 0 015.683-3.879 30.731 30.731 0 016.496-2.57c2.314-.632 4.855-.948 7.624-.948 5.832 0 10.63 1.579 14.39 4.736 3.758 3.157 6.57 7.352 8.434 12.585 1.444-3.068 3.248-5.698 5.413-7.894 2.165-2.194 4.541-3.984 7.127-5.367a32.848 32.848 0 018.254-3.068 39.597 39.597 0 018.796-.992c5.111 0 9.653.783 13.622 2.345 3.97 1.565 7.307 3.849 10.014 6.857 2.706 3.007 4.766 6.675 6.18 11.005C739.29 83.537 740 88.5 740 94.092V153h-22.284V94.092c0-5.894-1.294-10.329-3.878-13.306-2.587-2.977-6.376-4.465-11.368-4.465-2.286 0-4.404.391-6.358 1.172a15.189 15.189 0 00-5.144 3.383c-1.473 1.474-2.631 3.324-3.474 5.548-.842 2.225-1.263 4.781-1.263 7.668V153h-22.37V94.092c0-6.194-1.249-10.704-3.744-13.532-2.497-2.825-6.18-4.24-11.051-4.24-3.19 0-6.18.798-8.976 2.391-2.799 1.593-5.399 3.775-7.804 6.54V153H610zM572 30h23v19h-23z"
            fill="currentColor"
            fill-opacity=".8"
          />
        </g>
      </g>
    </svg>
  
          <!--<img src="https://neovim.io/logos/neovim-logo.svg" width="173" height="50" alt="Neovim" />-->
        </a>
        <div id="docsearch"></div> <!-- algolia docsearch https://docsearch.algolia.com/docs/docsearch-v3/ -->
      </div>
    </nav>
  </header>

  <div class="container golden-grid help-body">
  <div class="col-wide">
  <a name="lua-guide.txt" href="#lua-guide"><h1 id="lua-guide"> Lua-guide</h1></a>
  <p>
    <i>
    Nvim <code>:help</code> pages, <a href="https://github.com/neovim/neovim/blob/master/src/gen/gen_help_html.lua">generated</a>
    from <a href="https://github.com/neovim/neovim/blob/master/runtime/doc/lua-guide.txt">source</a>
    using the <a href="https://github.com/neovim/tree-sitter-vimdoc">tree-sitter-vimdoc</a> parser.
    </i>
  </p>
  <hr/>
  <div class="help-para">
                          Guide to using Lua in Nvim

</div>
<div class="help-para">
<h2 id="_introduction" class="help-heading">Introduction</h2>


</div>
<div class="help-para">
This guide introduces the basics of everyday Lua usage for configuring and
controlling Nvim. It assumes some familiarity with the (non-Lua) basics of
Nvim (commands, options, mappings, autocommands), which are covered in the
<a href="usr_toc.html#user-manual">user-manual</a>.

</div>
<div class="help-para">
This is not a comprehensive encyclopedia of all available features. Think of
it as a survival kit: the bare minimum needed to comfortably get started on
using Lua in Nvim.

</div>
<div class="help-para">
See <a href="lua-plugin.html#lua-plugin">lua-plugin</a> for guidance on developing Lua plugins.
See <a href="luaref.html#luaref">luaref</a> and <a href="lua.html#lua-concepts">lua-concepts</a> for details on the Lua programming language.

</div>
<div class="help-para">
<h3 id="_some-words-on-the-api" class="help-heading">Some words on the API<span class="help-heading-tags">                                            <span id="lua-guide-api" class="help-tag"><a href="#lua-guide-api">lua-guide-api</a></span></h3>


</div>
<div class="help-para">
The purpose of this guide is to introduce the different ways of interacting
with Nvim through Lua (the "API"). This API consists of three different
layers:

</div>
<div class="help-para">
<div class="help-li-num" style=""> The "Vim API" inherited from Vim: <a href="vimindex.html#Ex-commands">Ex-commands</a> and <a href="vimfn.html#vimscript-functions">vimscript-functions</a>
   as well as <a href="vimeval.html#user-function">user-function</a>s in Vimscript. These are accessed through
   <a href="lua.html#vim.cmd()">vim.cmd()</a> and <a href="lua.html#vim.fn">vim.fn</a> respectively, which are discussed under
   <a href="lua-guide.html#lua-guide-vimscript">lua-guide-vimscript</a> below.
</div><div class="help-li-num" style=""> The "Nvim API" written in C for use in remote plugins and GUIs; see <a href="api.html#api">api</a>.
   These functions are accessed through <a href="lua.html#vim.api">vim.api</a>.
</div><div class="help-li-num" style=""> The "Lua API" written in and specifically for Lua. These are any other
   functions accessible through <code>vim.*</code> not mentioned already; see
   <a href="lua.html#lua-stdlib">lua-stdlib</a>.
</div>
</div>
<div class="help-para">
This distinction is important, as API functions inherit behavior from their
original layer: For example, Nvim API functions always need all arguments to
be specified even if Lua itself allows omitting arguments (which are then
passed as <code>nil</code>); and Vim API functions can use 0-based indexing even if Lua
arrays are 1-indexed by default.

</div>
<div class="help-para">
Through this, any possible interaction can be done through Lua without writing
a complete new API from scratch. For this reason, functions are usually not
duplicated between layers unless there is a significant benefit in
functionality or performance (e.g., you can map Lua functions directly through
<a href="api.html#nvim_create_autocmd()">nvim_create_autocmd()</a> but not through <a href="autocmd.html#%3Aautocmd">:autocmd</a>). In case there are multiple
ways of achieving the same thing, this guide will only cover what is most
convenient to use from Lua.

</div>
<div class="help-para">
<h2 id="_using-lua" class="help-heading">Using Lua<span class="help-heading-tags">                                                  <span id="lua-guide-using-Lua" class="help-tag"><a href="#lua-guide-using-Lua">lua-guide-using-Lua</a></span></h2>


</div>
<div class="help-para">
To run Lua code from the Nvim command line, use the <a href="lua.html#%3Alua">:lua</a> command:
<pre><code class="language-vim">:lua print("Hello!")</code></pre>

</div>
<div class="help-para">
<b>Note:</b> each <a href="lua.html#%3Alua">:lua</a> command has its own scope and variables declared with the
local keyword are not accessible outside of the command. This won't work:
<pre><code class="language-vim">:lua local foo = 1
:lua print(foo)
" prints "nil" instead of "1"</code></pre>

</div>
<div class="help-para">
You can also use <code>:lua=</code>, which is equivalent to <code>:lua vim.print(...)</code>, to
conveniently check the value of a variable or a table:
<pre><code class="language-vim">:lua =package</code></pre>

</div>
<div class="help-para">
To run a Lua script in an external file, you can use the <a href="repeat.html#%3Asource">:source</a> command
exactly like for a Vimscript file:
<pre><code class="language-vim">:source ~/programs/baz/myluafile.lua</code></pre>

</div>
<div class="help-para">
Finally, you can include Lua code in a Vimscript file by putting it inside a
<a href="lua.html#%3Alua-heredoc">:lua-heredoc</a> block:
<pre><code class="language-vim">lua &lt;&lt; EOF
  local tbl = {1, 2, 3}
  for k, v in ipairs(tbl) do
    print(v)
  end
EOF</code></pre>

</div>
<div class="help-para">
<h3 id="_using-lua-files-on-startup" class="help-heading">Using Lua files on startup<span class="help-heading-tags">                                    <span id="lua-guide-config" class="help-tag"><a href="#lua-guide-config">lua-guide-config</a></span></h3>


</div>
<div class="help-para">
Nvim supports using <code>init.vim</code> or <code>init.lua</code> as the configuration file, but
not both at the same time. This should be placed in your <a href="starting.html#config">config</a> directory
(run <code>:echo stdpath('config')</code> to see where it is). Note that you can also use
Lua in <code>init.vim</code> and Vimscript in <code>init.lua</code>, which will be covered below.

</div>
<div class="help-para">
If you'd like to run any other Lua script on <a href="starting.html#startup">startup</a> automatically, then you
can simply put it in <code>plugin/</code> in your <a href="options.html#'runtimepath'">'runtimepath'</a>.

</div>
<div class="help-para">
<h3 id="_lua-modules" class="help-heading">Lua modules<span class="help-heading-tags">                                                  <span id="lua-guide-modules" class="help-tag"><a href="#lua-guide-modules">lua-guide-modules</a></span></h3>


</div>
<div class="help-para">
If you want to load Lua files on demand, you can place them in the <code>lua/</code>
directory in your <a href="options.html#'runtimepath'">'runtimepath'</a> and load them with <code>require</code>. (This is the
Lua equivalent of Vimscript's <a href="userfunc.html#autoload">autoload</a> mechanism.)

</div>
<div class="help-para">
Let's assume you have the following directory structure:
<pre>~/.config/nvim
|-- after/
|-- ftplugin/
|-- lua/
|   |-- myluamodule.lua
|   |-- other_modules/
|       |-- anothermodule.lua
|       |-- init.lua
|-- plugin/
|-- syntax/
|-- init.vim</pre>

</div>
<div class="help-para">
Then the following Lua code will load <code>myluamodule.lua</code>:
<pre><code class="language-lua">require("myluamodule")</code></pre>

</div>
<div class="help-para">
Note the absence of a <code>.lua</code> extension.

</div>
<div class="help-para">
Similarly, loading <code>other_modules/anothermodule.lua</code> is done via
<pre><code class="language-lua">require('other_modules/anothermodule')
-- or
require('other_modules.anothermodule')</code></pre>

</div>
<div class="help-para">
Note how "submodules" are just subdirectories; the <code>.</code> is equivalent to the
path separator <code>/</code> (even on Windows).

</div>
<div class="help-para">
A folder containing an <a href="starting.html#init.lua">init.lua</a> file can be required directly, without
having to specify the name of the file:
<pre><code class="language-lua">require('other_modules') -- loads other_modules/init.lua</code></pre>

</div>
<div class="help-para">
Requiring a nonexistent module or a module which contains syntax errors aborts
the currently executing script. <code>pcall()</code> may be used to catch such errors. The
following example tries to load the <code>module_with_error</code> and only calls one of
its functions if this succeeds and prints an error message otherwise:
<pre><code class="language-lua">local ok, mymod = pcall(require, 'module_with_error')
if not ok then
  print("Module had an error")
else
  mymod.func()
end</code></pre>

</div>
<div class="help-para">
In contrast to <a href="repeat.html#%3Asource">:source</a>, <a href="luaref.html#require()">require()</a> not only searches through all <code>lua/</code> directories
under <a href="options.html#'runtimepath'">'runtimepath'</a>, it also caches the module on first use. Calling
<code>require()</code> a second time will therefore _not_ execute the script again and
instead return the cached file. To rerun the file, you need to remove it from
the cache manually first:
<pre><code class="language-lua">package.loaded['myluamodule'] = nil
require('myluamodule')    -- read and execute the module again from disk</code></pre>

</div>
<div class="help-para">
<h3 id="_see-also:" class="help-heading">See also:</h3>

<div class="help-li" style=""> <a href="lua.html#lua-module-load">lua-module-load</a>: how <code>require()</code> finds modules
</div><div class="help-li" style=""> <a href="luaref.html#pcall()">pcall()</a>
</div>
</div>
<div class="help-para">
<h2 id="_using-vim-commands-and-functions-from-lua" class="help-heading">Using Vim commands and functions from Lua<span class="help-heading-tags">                  <span id="lua-guide-vimscript" class="help-tag"><a href="#lua-guide-vimscript">lua-guide-vimscript</a></span></h2>


</div>
<div class="help-para">
All Vim commands and functions are accessible from Lua.

</div>
<div class="help-para">
<h3 id="_vim-commands" class="help-heading">Vim commands<span class="help-heading-tags">                                            <span id="lua-guide-vim-commands" class="help-tag"><a href="#lua-guide-vim-commands">lua-guide-vim-commands</a></span></h3>


</div>
<div class="help-para">
To run an arbitrary Vim command from Lua, pass it as a string to <a href="lua.html#vim.cmd()">vim.cmd()</a>:
<pre><code class="language-lua">vim.cmd("colorscheme habamax")</code></pre>

</div>
<div class="help-para">
Note that special characters will need to be escaped with backslashes:
<pre><code class="language-lua">vim.cmd("%s/\\Vfoo/bar/g")</code></pre>

</div>
<div class="help-para">
An alternative is to use a literal string (see <a href="luaref.html#lua-literal">lua-literal</a>) delimited by
double brackets <code>[[ ]]</code> as in
<pre><code class="language-lua">vim.cmd([[%s/\Vfoo/bar/g]])</code></pre>

</div>
<div class="help-para">
Another benefit of using literal strings is that they can be multiple lines;
this allows you to pass multiple commands to a single call of <a href="lua.html#vim.cmd()">vim.cmd()</a>:
<pre><code class="language-lua">vim.cmd([[
  highlight Error guibg=red
  highlight link Warning Error
]])</code></pre>

</div>
<div class="help-para">
This is the converse of <a href="lua.html#%3Alua-heredoc">:lua-heredoc</a> and allows you to include Vimscript
code in your <code>init.lua</code>.

</div>
<div class="help-para">
If you want to build your Vim command programmatically, the following form can
be useful (all these are equivalent to the corresponding line above):
<pre><code class="language-lua">vim.cmd.colorscheme("habamax")
vim.cmd.highlight({ "Error", "guibg=red" })
vim.cmd.highlight({ "link", "Warning", "Error" })</code></pre>

</div>
<div class="help-para">
<h3 id="_vimscript-functions" class="help-heading">Vimscript functions<span class="help-heading-tags">                                    <span id="lua-guide-vim-functions" class="help-tag"><a href="#lua-guide-vim-functions">lua-guide-vim-functions</a></span></h3>


</div>
<div class="help-para">
Use <a href="lua.html#vim.fn">vim.fn</a> to call Vimscript functions from Lua. Data types between Lua and
Vimscript are automatically converted:
<pre><code class="language-lua">print(vim.fn.printf('Hello from %s', 'Lua'))
local reversed_list = vim.fn.reverse({ 'a', 'b', 'c' })
vim.print(reversed_list) -- { "c", "b", "a" }
local function print_stdout(chan_id, data, name)
  print(data[1])
end
vim.fn.jobstart('ls', { on_stdout = print_stdout })</code></pre>

</div>
<div class="help-para">
This works for both <a href="vimfn.html#vimscript-functions">vimscript-functions</a> and <a href="vimeval.html#user-function">user-function</a>s.

</div>
<div class="help-para">
Note that hashes (<code>#</code>) are not valid characters for identifiers in Lua, so,
e.g., <a href="userfunc.html#autoload">autoload</a> functions have to be called with this syntax:
<pre><code class="language-lua">vim.fn['my#autoload#function']()</code></pre>

</div>
<div class="help-para">
<h3 id="_see-also:" class="help-heading">See also:</h3>

<div class="help-li" style=""> <a href="vimfn.html#vimscript-functions">vimscript-functions</a>: descriptions of all Vimscript functions
</div><div class="help-li" style=""> <a href="usr_41.html#function-list">function-list</a>: Vimscript functions grouped by topic
</div><div class="help-li" style=""> <a href="repeat.html#%3Aruntime">:runtime</a>: run all Lua scripts matching a pattern in <a href="options.html#'runtimepath'">'runtimepath'</a>
</div>
</div>
<div class="help-para">
<h2 id="_variables" class="help-heading">Variables<span class="help-heading-tags">                                                  <span id="lua-guide-variables" class="help-tag"><a href="#lua-guide-variables">lua-guide-variables</a></span></h2>


</div>
<div class="help-para">
Variables can be set and read using the following wrappers, which directly
correspond to their <a href="vimeval.html#variable-scope">variable-scope</a>:

</div>
<div class="help-para">
<div class="help-li" style=""> <a href="lua.html#vim.g">vim.g</a>:   global variables (<a href="vimeval.html#g%3A">g:</a>)
</div><div class="help-li" style=""> <a href="lua.html#vim.b">vim.b</a>:   variables for the current buffer (<a href="vimeval.html#b%3A">b:</a>)
</div><div class="help-li" style=""> <a href="lua.html#vim.w">vim.w</a>:   variables for the current window (<a href="vimeval.html#w%3A">w:</a>)
</div><div class="help-li" style=""> <a href="lua.html#vim.t">vim.t</a>:   variables for the current tabpage (<a href="vimeval.html#t%3A">t:</a>)
</div><div class="help-li" style=""> <a href="lua.html#vim.v">vim.v</a>:   predefined Vim variables (<a href="vimeval.html#v%3A">v:</a>)
</div><div class="help-li" style=""> <a href="lua.html#vim.env">vim.env</a>: environment variables defined in the editor session
</div>
</div>
<div class="help-para">
Data types are converted automatically. For example:
<pre><code class="language-lua">vim.g.some_global_variable = {
  key1 = "value",
  key2 = 300
}
vim.print(vim.g.some_global_variable)
--&gt; { key1 = "value", key2 = 300 }</code></pre>

</div>
<div class="help-para">
You can target specific buffers (via number), windows (via <a href="windows.html#window-ID">window-ID</a>), or
tabpages by indexing the wrappers:
<pre><code class="language-lua">vim.b[2].myvar = 1               -- set myvar for buffer number 2
vim.w[1005].myothervar = true    -- set myothervar for window ID 1005</code></pre>

</div>
<div class="help-para">
Some variable names may contain characters that cannot be used for identifiers
in Lua. You can still manipulate these variables by using the syntax
<pre><code class="language-lua">vim.g['my#variable'] = 1</code></pre>

</div>
<div class="help-para">
Note that you cannot directly change fields of array variables. This won't
work:
<pre><code class="language-lua">vim.g.some_global_variable.key2 = 400
vim.print(vim.g.some_global_variable)
--&gt; { key1 = "value", key2 = 300 }</code></pre>

</div>
<div class="help-para">
Instead, you need to create an intermediate Lua table and change this:
<pre><code class="language-lua">local temp_table = vim.g.some_global_variable
temp_table.key2 = 400
vim.g.some_global_variable = temp_table
vim.print(vim.g.some_global_variable)
--&gt; { key1 = "value", key2 = 400 }</code></pre>

</div>
<div class="help-para">
To delete a variable, simply set it to <code>nil</code>:
<pre><code class="language-lua">vim.g.myvar = nil</code></pre>

</div>
<div class="help-para">
<h3 id="_see-also:" class="help-heading">See also:</h3>

<div class="help-li" style=""> <a href="lua.html#lua-vim-variables">lua-vim-variables</a>
</div>
</div>
<div class="help-para">
<h2 id="_options" class="help-heading">Options<span class="help-heading-tags">                                                      <span id="lua-guide-options" class="help-tag"><a href="#lua-guide-options">lua-guide-options</a></span></h2>


</div>
<div class="help-para">
There are two complementary ways of setting <a href="options.html#options">options</a> via Lua.

</div>
<div class="help-para">
<h3 id="_vim.opt" class="help-heading">vim.opt</h3>


</div>
<div class="help-para">
The most convenient way for setting global and local options, e.g., in <code>init.lua</code>,
is through <code>vim.opt</code> and friends:

</div>
<div class="help-para">
<div class="help-li" style=""> <a href="lua.html#vim.opt">vim.opt</a>:        behaves like <a href="options.html#%3Aset">:set</a>
</div><div class="help-li" style=""> <a href="lua.html#vim.opt_global">vim.opt_global</a>: behaves like <a href="options.html#%3Asetglobal">:setglobal</a>
</div><div class="help-li" style=""> <a href="lua.html#vim.opt_local">vim.opt_local</a>:  behaves like <a href="options.html#%3Asetlocal">:setlocal</a>
</div>
</div>
<div class="help-para">
For example, the Vimscript commands
<pre><code class="language-vim">set smarttab
set nosmarttab</code></pre>

</div>
<div class="help-para">
are equivalent to
<pre><code class="language-lua">vim.opt.smarttab = true
vim.opt.smarttab = false</code></pre>

</div>
<div class="help-para">
In particular, they allow an easy way to working with list-like, map-like, and
set-like options through Lua tables: Instead of
<pre><code class="language-vim">set wildignore=*.o,*.a,__pycache__
set listchars=space:_,tab:&gt;~
set formatoptions=njt</code></pre>

</div>
<div class="help-para">
you can use
<pre><code class="language-lua">vim.opt.wildignore = { '*.o', '*.a', '__pycache__' }
vim.opt.listchars = { space = '_', tab = '&gt;~' }
vim.opt.formatoptions = { n = true, j = true, t = true }</code></pre>

</div>
<div class="help-para">
These wrappers also come with methods that work similarly to their <a href="options.html#%3Aset%2B%3D">:set+=</a>,
<a href="options.html#%3Aset%5E%3D">:set^=</a> and <a href="options.html#%3Aset-%3D">:set-=</a> counterparts in Vimscript:
<pre><code class="language-lua">vim.opt.shortmess:append({ I = true })
vim.opt.wildignore:prepend('*.o')
vim.opt.whichwrap:remove({ 'b', 's' })</code></pre>

</div>
<div class="help-para">
The price to pay is that you cannot access the option values directly but must
use <a href="lua.html#vim.opt%3Aget()">vim.opt:get()</a>:
<pre><code class="language-lua">print(vim.opt.smarttab)
--&gt; {...} (big table)
print(vim.opt.smarttab:get())
--&gt; false
vim.print(vim.opt.listchars:get())
--&gt; { space = '_', tab = '&gt;~' }</code></pre>

</div>
<div class="help-para">
<h3 id="_vim.o" class="help-heading">vim.o</h3>


</div>
<div class="help-para">
For this reason, there exists a more direct variable-like access using <code>vim.o</code>
and friends, similarly to how you can get and set options via <code>:echo &amp;number</code>
and <code>:let &amp;listchars='space:_,tab:&gt;~'</code>:

</div>
<div class="help-para">
<div class="help-li" style=""> <a href="lua.html#vim.o">vim.o</a>:  behaves like <a href="options.html#%3Aset">:set</a>
</div><div class="help-li" style=""> <a href="lua.html#vim.go">vim.go</a>: behaves like <a href="options.html#%3Asetglobal">:setglobal</a>
</div><div class="help-li" style=""> <a href="lua.html#vim.bo">vim.bo</a>: for buffer-scoped options
</div><div class="help-li" style=""> <a href="lua.html#vim.wo">vim.wo</a>: for window-scoped options (can be double indexed)
</div>
</div>
<div class="help-para">
For example:
<pre><code class="language-lua">vim.o.smarttab = false -- :set nosmarttab
print(vim.o.smarttab)
--&gt; false
vim.o.listchars = 'space:_,tab:&gt;~' -- :set listchars='space:_,tab:&gt;~'
print(vim.o.listchars)
--&gt; 'space:_,tab:&gt;~'
vim.o.isfname = vim.o.isfname .. ',@-@' -- :set isfname+=@-@
print(vim.o.isfname)
--&gt; '@,48-57,/,.,-,_,+,,,#,$,%,~,=,@-@'
vim.bo.shiftwidth = 4 -- :setlocal shiftwidth=4
print(vim.bo.shiftwidth)
--&gt; 4</code></pre>

</div>
<div class="help-para">
Just like variables, you can specify a buffer number or <a href="windows.html#window-ID">window-ID</a> for buffer
and window options, respectively. If no number is given, the current buffer or
window is used:
<pre><code class="language-lua">vim.bo[4].expandtab = true -- sets expandtab to true in buffer 4
vim.wo.number = true       -- sets number to true in current window
vim.wo[0].number = true    -- same as above
vim.wo[0][0].number = true -- sets number to true in current buffer
                           -- in current window only
print(vim.wo[0].number)    --&gt; true</code></pre>

</div>
<div class="help-para">
<h3 id="_see-also:" class="help-heading">See also:</h3>

<div class="help-li" style=""> <a href="lua.html#lua-options">lua-options</a>
</div>
</div>
<div class="help-para">
<h2 id="_mappings" class="help-heading">Mappings<span class="help-heading-tags">                                                    <span id="lua-guide-mappings" class="help-tag"><a href="#lua-guide-mappings">lua-guide-mappings</a></span></h2>


</div>
<div class="help-para">
You can map either Vim commands or Lua functions to key sequences.

</div>
<div class="help-para">
<h3 id="_creating-mappings" class="help-heading">Creating mappings<span class="help-heading-tags">                                       <span id="lua-guide-mappings-set" class="help-tag"><a href="#lua-guide-mappings-set">lua-guide-mappings-set</a></span></h3>


</div>
<div class="help-para">
Mappings can be created using <a href="lua.html#vim.keymap.set()">vim.keymap.set()</a>. This function takes three
mandatory arguments:
<div class="help-li" style=""> <code>{mode}</code> is a string or a table of strings containing the mode
  prefix for which the mapping will take effect. The prefixes are the ones
  listed in <a href="map.html#%3Amap-modes">:map-modes</a>, or "!" for <a href="map.html#%3Amap%21">:map!</a>, or empty string for <a href="map.html#%3Amap">:map</a>.
</div><div class="help-li" style=""> <code>{lhs}</code> is a string with the key sequences that should trigger the mapping.
</div><div class="help-li" style=""> <code>{rhs}</code> is either a string with a Vim command or a Lua function that should
  be executed when the <code>{lhs}</code> is entered.
  An empty string is equivalent to <a href="intro.html#%3CNop%3E">&lt;Nop&gt;</a>, which disables a key.
</div>
</div>
<div class="help-para">
Examples:
<pre><code class="language-lua">-- Normal mode mapping for Vim command
vim.keymap.set('n', '&lt;Leader&gt;ex1', '&lt;cmd&gt;echo "Example 1"&lt;cr&gt;')
-- Normal and Command-line mode mapping for Vim command
vim.keymap.set({'n', 'c'}, '&lt;Leader&gt;ex2', '&lt;cmd&gt;echo "Example 2"&lt;cr&gt;')
-- Normal mode mapping for Lua function
vim.keymap.set('n', '&lt;Leader&gt;ex3', vim.treesitter.start)
-- Normal mode mapping for Lua function with arguments
vim.keymap.set('n', '&lt;Leader&gt;ex4', function() print('Example 4') end)</code></pre>

</div>
<div class="help-para">
You can map functions from Lua modules via
<pre><code class="language-lua">vim.keymap.set('n', '&lt;Leader&gt;pl1', require('plugin').action)</code></pre>

</div>
<div class="help-para">
Note that this loads the plugin at the time the mapping is defined. If you
want to defer the loading to the time when the mapping is executed (as for
<a href="userfunc.html#autoload">autoload</a> functions), wrap it in <code>function() end</code>:
<pre><code class="language-lua">vim.keymap.set('n', '&lt;Leader&gt;pl2', function() require('plugin').action() end)</code></pre>

</div>
<div class="help-para">
The fourth, optional, argument is a table with keys that modify the behavior
of the mapping such as those from <a href="map.html#%3Amap-arguments">:map-arguments</a>. The following are the most
useful options:
<div class="help-li" style=""> <code>buffer</code>: If given, only set the mapping for the buffer with the specified
  number; <code>0</code> or <code>true</code> means the current buffer.<pre><code class="language-lua">-- set mapping for the current buffer
vim.keymap.set('n', '&lt;Leader&gt;pl1', require('plugin').action, { buffer = true })
-- set mapping for the buffer number 4
vim.keymap.set('n', '&lt;Leader&gt;pl1', require('plugin').action, { buffer = 4 })</code></pre>
</div>
</div>
<div class="help-para">
<div class="help-li" style=""> <code>silent</code>: If set to <code>true</code>, suppress output such as error messages.
<pre><code class="language-lua">vim.keymap.set('n', '&lt;Leader&gt;pl1', require('plugin').action, { silent = true })</code></pre></div>
</div>
<div class="help-para">
<div class="help-li" style=""> <code>expr</code>: If set to <code>true</code>, do not execute the <code>{rhs}</code> but use the return value
  as input. Special <a href="intro.html#keycodes">keycodes</a> are converted automatically. For example, the following
  mapping replaces <code>&lt;down&gt;</code> with <code>&lt;c-n&gt;</code> in the popupmenu only:<pre><code class="language-lua">vim.keymap.set('c', '&lt;down&gt;', function()
  if vim.fn.pumvisible() == 1 then return '&lt;c-n&gt;' end
  return '&lt;down&gt;'
end, { expr = true })</code></pre>
</div>
</div>
<div class="help-para">
<div class="help-li" style=""> <code>desc</code>: A string that is shown when listing mappings with, e.g., <a href="map.html#%3Amap">:map</a>.
  This is useful since Lua functions as <code>{rhs}</code> are otherwise only listed as
  <code>Lua: &lt;number&gt; &lt;source file&gt;:&lt;line&gt;</code>. Plugins should therefore always use this
  for mappings they create.<pre><code class="language-lua">vim.keymap.set('n', '&lt;Leader&gt;pl1', require('plugin').action,
  { desc = 'Execute action from plugin' })</code></pre>
</div>
</div>
<div class="help-para">
<div class="help-li" style=""> <code>remap</code>: By default, all mappings are nonrecursive (i.e., <a href="lua.html#vim.keymap.set()">vim.keymap.set()</a>
  behaves like <a href="map.html#%3Anoremap">:noremap</a>). If the <code>{rhs}</code> is itself a mapping that should be
  executed, set <code>remap = true</code>:<pre><code class="language-lua">vim.keymap.set('n', '&lt;Leader&gt;ex1', '&lt;cmd&gt;echo "Example 1"&lt;cr&gt;')
-- add a shorter mapping
vim.keymap.set('n', 'e', '&lt;Leader&gt;ex1', { remap = true })</code></pre>
</div>
</div>
<div class="help-para">
<b>  Note:</b> <a href="map.html#%3CPlug%3E">&lt;Plug&gt;</a> mappings are always expanded even with the default <code>remap = false</code>:<pre><code class="language-lua">vim.keymap.set('n', '[%', '&lt;Plug&gt;(MatchitNormalMultiBackward)')</code></pre>

</div>
<div class="help-para">
<h3 id="_removing-mappings" class="help-heading">Removing mappings<span class="help-heading-tags">                                       <span id="lua-guide-mappings-del" class="help-tag"><a href="#lua-guide-mappings-del">lua-guide-mappings-del</a></span></h3>


</div>
<div class="help-para">
A specific mapping can be removed with <a href="lua.html#vim.keymap.del()">vim.keymap.del()</a>:
<pre><code class="language-lua">vim.keymap.del('n', '&lt;Leader&gt;ex1')
vim.keymap.del({'n', 'c'}, '&lt;Leader&gt;ex2', {buffer = true})</code></pre>

</div>
<div class="help-para">
<h3 id="_see-also:" class="help-heading">See also:</h3>

<div class="help-li" style=""> <code>vim.api.</code><a href="api.html#nvim_get_keymap()">nvim_get_keymap()</a>:     return all global mapping
</div><div class="help-li" style=""> <code>vim.api.</code><a href="api.html#nvim_buf_get_keymap()">nvim_buf_get_keymap()</a>: return all mappings for buffer
</div>
</div>
<div class="help-para">
<h2 id="_autocommands" class="help-heading">Autocommands<span class="help-heading-tags">                                            <span id="lua-guide-autocommands" class="help-tag"><a href="#lua-guide-autocommands">lua-guide-autocommands</a></span></h2>


</div>
<div class="help-para">
An <a href="autocmd.html#autocommand">autocommand</a> is a Vim command or a Lua function that is automatically
executed whenever one or more <a href="autocmd.html#events">events</a> are triggered, e.g., when a file is
read or written, or when a window is created. These are accessible from Lua
through the Nvim API.

</div>
<div class="help-para">
<h3 id="_creating-autocommands" class="help-heading">Creating autocommands<span class="help-heading-tags">                             <span id="lua-guide-autocommand-create" class="help-tag"><a href="#lua-guide-autocommand-create">lua-guide-autocommand-create</a></span></h3>


</div>
<div class="help-para">
Autocommands are created using <code>vim.api.</code><a href="api.html#nvim_create_autocmd()">nvim_create_autocmd()</a>, which takes
two mandatory arguments:
<div class="help-li" style=""> <code>{event}</code>: a string or table of strings containing the event(s) which should
           trigger the command or function.
</div><div class="help-li" style=""> <code>{opts}</code>:  a table with keys that control what should happen when the event(s)
           are triggered.
</div>
</div>
<div class="help-para">
The most important options are:

</div>
<div class="help-para">
<div class="help-li" style=""> <code>pattern</code>:  A string or table of strings containing the <a href="autocmd.html#autocmd-pattern">autocmd-pattern</a>.
<b>            Note:</b> Environment variable like <code>$HOME</code> and <code>~</code> are not automatically
            expanded; you need to explicitly use <code>vim.fn.</code><a href="vimfn.html#expand()">expand()</a> for this.
</div><div class="help-li" style=""> <code>command</code>:  A string containing a Vim command.
</div><div class="help-li" style=""> <code>callback</code>: A Lua function.
</div>
</div>
<div class="help-para">
You must specify one and only one of <code>command</code> and <code>callback</code>. If <code>pattern</code> is
omitted, it defaults to <code>pattern = '*'</code>.
Examples:
<pre><code class="language-lua">vim.api.nvim_create_autocmd({"BufEnter", "BufWinEnter"}, {
  pattern = {"*.c", "*.h"},
  command = "echo 'Entering a C or C++ file'",
})
-- Same autocommand written with a Lua function instead
vim.api.nvim_create_autocmd({"BufEnter", "BufWinEnter"}, {
  pattern = {"*.c", "*.h"},
  callback = function() print("Entering a C or C++ file") end,
})
-- User event triggered by MyPlugin
vim.api.nvim_create_autocmd("User", {
  pattern = "MyPlugin",
  callback = function() print("My Plugin Works!") end,
})</code></pre>

</div>
<div class="help-para">
Nvim will always call a Lua function with a single table containing information
about the triggered autocommand. The most useful keys are
<div class="help-li" style=""> <code>match</code>: a string that matched the <code>pattern</code> (see <a href="cmdline.html#%3Camatch%3E">&lt;amatch&gt;</a>)
</div><div class="help-li" style=""> <code>buf</code>:   the number of the buffer the event was triggered in (see <a href="cmdline.html#%3Cabuf%3E">&lt;abuf&gt;</a>)
</div><div class="help-li" style=""> <code>file</code>:  the file name of the buffer the event was triggered in (see <a href="cmdline.html#%3Cafile%3E">&lt;afile&gt;</a>)
</div><div class="help-li" style=""> <code>data</code>:  a table with other relevant data that is passed for some events
</div>
</div>
<div class="help-para">
For example, this allows you to set buffer-local mappings for some filetypes:
<pre><code class="language-lua">vim.api.nvim_create_autocmd("FileType", {
  pattern = "lua",
  callback = function(args)
    vim.keymap.set('n', 'K', vim.lsp.buf.hover, { buffer = args.buf })
  end
})</code></pre>

</div>
<div class="help-para">
This means that if your callback itself takes an (even optional) argument, you
must wrap it in <code>function() end</code> to avoid an error:
<pre><code class="language-lua">vim.api.nvim_create_autocmd('TextYankPost', {
  callback = function() vim.hl.on_yank() end
})</code></pre>

</div>
<div class="help-para">
(Since unused arguments can be omitted in Lua function definitions, this is
equivalent to <code>function(args) ... end</code>.)

</div>
<div class="help-para">
Instead of using a pattern, you can create a buffer-local autocommand (see
<a href="autocmd.html#autocmd-buflocal">autocmd-buflocal</a>) with <code>buffer</code>; in this case, <code>pattern</code> cannot be used:
<pre><code class="language-lua">-- set autocommand for current buffer
vim.api.nvim_create_autocmd("CursorHold", {
  buffer = 0,
  callback = function() print("hold") end,
})
-- set autocommand for buffer number 33
vim.api.nvim_create_autocmd("CursorHold", {
  buffer = 33,
  callback = function() print("hold") end,
})</code></pre>

</div>
<div class="help-para">
Similarly to mappings, you can (and should) add a description using <code>desc</code>:
<pre><code class="language-lua">vim.api.nvim_create_autocmd('TextYankPost', {
  callback = function() vim.hl.on_yank() end,
  desc = "Briefly highlight yanked text"
})</code></pre>

</div>
<div class="help-para">
Finally, you can group autocommands using the <code>group</code> key; this will be
covered in detail in the next section.

</div>
<div class="help-para">
<h3 id="_grouping-autocommands" class="help-heading">Grouping autocommands<span class="help-heading-tags">                             <span id="lua-guide-autocommands-group" class="help-tag"><a href="#lua-guide-autocommands-group">lua-guide-autocommands-group</a></span></h3>


</div>
<div class="help-para">
Autocommand groups can be used to group related autocommands together; see
<a href="autocmd.html#autocmd-groups">autocmd-groups</a>. This is useful for organizing autocommands and especially
for preventing autocommands to be set multiple times.

</div>
<div class="help-para">
Groups can be created with <code>vim.api.</code><a href="api.html#nvim_create_augroup()">nvim_create_augroup()</a>. This function
takes two mandatory arguments: a string with the name of a group and a table
determining whether the group should be cleared (i.e., all grouped
autocommands removed) if it already exists. The function returns a number that
is the internal identifier of the group. Groups can be specified either by
this identifier or by the name (but only if the group has been created first).

</div>
<div class="help-para">
For example, a common Vimscript pattern for autocommands defined in files that
may be reloaded is
<pre><code class="language-vim">augroup vimrc
  " Remove all vimrc autocommands
  autocmd!
  au BufNewFile,BufRead *.html set shiftwidth=4
  au BufNewFile,BufRead *.html set expandtab
augroup END</code></pre>

</div>
<div class="help-para">
This is equivalent to the following Lua code:
<pre><code class="language-lua">local mygroup = vim.api.nvim_create_augroup('vimrc', { clear = true })
vim.api.nvim_create_autocmd({ 'BufNewFile', 'BufRead' }, {
  pattern = '*.html',
  group = mygroup,
  command = 'set shiftwidth=4',
})
vim.api.nvim_create_autocmd({ 'BufNewFile', 'BufRead' }, {
  pattern = '*.html',
  group = 'vimrc',  -- equivalent to group=mygroup
  command = 'set expandtab',
})</code></pre>

</div>
<div class="help-para">
Autocommand groups are unique for a given name, so you can reuse them, e.g.,
in a different file:
<pre><code class="language-lua">local mygroup = vim.api.nvim_create_augroup('vimrc', { clear = false })
vim.api.nvim_create_autocmd({ 'BufNewFile', 'BufRead' }, {
  pattern = '*.c',
  group = mygroup,
  command = 'set noexpandtab',
})</code></pre>

</div>
<div class="help-para">
<h3 id="_deleting-autocommands" class="help-heading">Deleting autocommands<span class="help-heading-tags">                            <span id="lua-guide-autocommands-delete" class="help-tag"><a href="#lua-guide-autocommands-delete">lua-guide-autocommands-delete</a></span></h3>


</div>
<div class="help-para">
You can use <code>vim.api.</code><a href="api.html#nvim_clear_autocmds()">nvim_clear_autocmds()</a> to remove autocommands. This
function takes a single mandatory argument that is a table of keys describing
the autocommands that are to be removed:
<pre><code class="language-lua">-- Delete all BufEnter and InsertLeave autocommands
vim.api.nvim_clear_autocmds({event = {"BufEnter", "InsertLeave"}})
-- Delete all autocommands that uses "*.py" pattern
vim.api.nvim_clear_autocmds({pattern = "*.py"})
-- Delete all autocommands in group "scala"
vim.api.nvim_clear_autocmds({group = "scala"})
-- Delete all ColorScheme autocommands in current buffer
vim.api.nvim_clear_autocmds({event = "ColorScheme", buffer = 0 })</code></pre>

</div>
<div class="help-para">
<b>Note:</b> Autocommands in groups will only be removed if the <code>group</code> key is
specified, even if another option matches it.

</div>
<div class="help-para">
<h3 id="_see-also" class="help-heading">See also</h3>

<div class="help-li" style=""> <a href="api.html#nvim_get_autocmds()">nvim_get_autocmds()</a>:  return all matching autocommands
</div><div class="help-li" style=""> <a href="api.html#nvim_exec_autocmds()">nvim_exec_autocmds()</a>: execute all matching autocommands
</div>
</div>
<div class="help-para">
<h2 id="_user-commands" class="help-heading">User commands<span class="help-heading-tags">                                           <span id="lua-guide-commands" class="help-tag"><a href="#lua-guide-commands">lua-guide-commands</a></span></h2>


</div>
<div class="help-para">
<a href="map.html#user-commands">user-commands</a> are custom Vim commands that call a Vimscript or Lua function.
Just like built-in commands, they can have arguments, act on ranges, or have
custom completion of arguments. As these are most useful for plugins, we will
cover only the basics of this advanced topic.

</div>
<div class="help-para">
<h3 id="_creating-user-commands" class="help-heading">Creating user commands<span class="help-heading-tags">                           <span id="lua-guide-commands-create" class="help-tag"><a href="#lua-guide-commands-create">lua-guide-commands-create</a></span></h3>


</div>
<div class="help-para">
User commands can be created via <a href="api.html#nvim_create_user_command()">nvim_create_user_command()</a>. This function
takes three mandatory arguments:
<div class="help-li" style=""> a string that is the name of the command (which must start with an uppercase
  letter to distinguish it from builtin commands);
</div><div class="help-li" style=""> a string containing Vim commands or a Lua function that is executed when the
  command is invoked;
</div><div class="help-li" style=""> a table with <a href="map.html#command-attributes">command-attributes</a>; in addition, it can contain the keys
  <code>desc</code> (a string describing the command); <code>force</code> (set to <code>false</code> to avoid
  replacing an already existing command with the same name), and <code>preview</code> (a
  Lua function that is used for <a href="map.html#%3Acommand-preview">:command-preview</a>).
</div>
</div>
<div class="help-para">
Example:
<pre><code class="language-lua">vim.api.nvim_create_user_command('Test', 'echo "It works!"', {})
vim.cmd.Test()
--&gt; It works!</code></pre>

</div>
<div class="help-para">
(Note that the third argument is mandatory even if no attributes are given.)

</div>
<div class="help-para">
Lua functions are called with a single table argument containing arguments and
modifiers. The most important are:
<div class="help-li" style=""> <code>name</code>: a string with the command name
</div><div class="help-li" style=""> <code>fargs</code>: a table containing the command arguments split by whitespace (see <a href="map.html#%3Cf-args%3E">&lt;f-args&gt;</a>)
</div><div class="help-li" style=""> <code>bang</code>: <code>true</code> if the command was executed with a <code>!</code> modifier (see <a href="map.html#%3Cbang%3E">&lt;bang&gt;</a>)
</div><div class="help-li" style=""> <code>line1</code>: the starting line number of the command range (see <a href="map.html#%3Cline1%3E">&lt;line1&gt;</a>)
</div><div class="help-li" style=""> <code>line2</code>: the final line number of the command range (see <a href="map.html#%3Cline2%3E">&lt;line2&gt;</a>)
</div><div class="help-li" style=""> <code>range</code>: the number of items in the command range: 0, 1, or 2 (see <a href="map.html#%3Crange%3E">&lt;range&gt;</a>)
</div><div class="help-li" style=""> <code>count</code>: any count supplied (see <a href="map.html#%3Ccount%3E">&lt;count&gt;</a>)
</div><div class="help-li" style=""> <code>smods</code>: a table containing the command modifiers (see <a href="map.html#%3Cmods%3E">&lt;mods&gt;</a>)
</div>
</div>
<div class="help-para">
For example:
<pre><code class="language-lua">vim.api.nvim_create_user_command('Upper',
  function(opts)
    print(string.upper(opts.fargs[1]))
  end,
  { nargs = 1 })
vim.cmd.Upper('foo')
--&gt; FOO</code></pre>

</div>
<div class="help-para">
The <code>complete</code> attribute can take a Lua function in addition to the
attributes listed in <a href="map.html#%3Acommand-complete">:command-complete</a>.<pre><code class="language-lua">vim.api.nvim_create_user_command('Upper',
  function(opts)
    print(string.upper(opts.fargs[1]))
  end,
  { nargs = 1,
    complete = function(ArgLead, CmdLine, CursorPos)
      -- return completion candidates as a list-like table
      return { "foo", "bar", "baz" }
    end,
})</code></pre>

</div>
<div class="help-para">
Buffer-local user commands are created with <code>vim.api.</code><a href="api.html#nvim_buf_create_user_command()">nvim_buf_create_user_command()</a>.
Here the first argument is the buffer number (<code>0</code> being the current buffer);
the remaining arguments are the same as for <a href="api.html#nvim_create_user_command()">nvim_create_user_command()</a>:
<pre><code class="language-lua">vim.api.nvim_buf_create_user_command(0, 'Upper',
  function(opts)
    print(string.upper(opts.fargs[1]))
  end,
  { nargs = 1 })</code></pre>

</div>
<div class="help-para">
<h3 id="_deleting-user-commands" class="help-heading">Deleting user commands<span class="help-heading-tags">                           <span id="lua-guide-commands-delete" class="help-tag"><a href="#lua-guide-commands-delete">lua-guide-commands-delete</a></span></h3>


</div>
<div class="help-para">
User commands can be deleted with <code>vim.api.</code><a href="api.html#nvim_del_user_command()">nvim_del_user_command()</a>. The only
argument is the name of the command:
<pre><code class="language-lua">vim.api.nvim_del_user_command('Upper')</code></pre>

</div>
<div class="help-para">
To delete buffer-local user commands use <code>vim.api.</code><a href="api.html#nvim_buf_del_user_command()">nvim_buf_del_user_command()</a>.
Here the first argument is the buffer number (<code>0</code> being the current buffer),
and second is command name:
<pre><code class="language-lua">vim.api.nvim_buf_del_user_command(4, 'Upper')</code></pre>

</div>
<div class="help-para">
<h2 id="_credits" class="help-heading">Credits<span class="help-heading-tags">                                                      <span id="lua-guide-credits" class="help-tag"><a href="#lua-guide-credits">lua-guide-credits</a></span></h2>

This guide is in large part taken from nanotee's Lua guide:
<a href="https://github.com/nanotee/nvim-lua-guide">https://github.com/nanotee/nvim-lua-guide</a>

</div>
<div class="help-para">
Thank you @nanotee!

</div>

  </div>
      <div class="col-narrow toc">
      <div><a href="index.html">Main</a></div>
      <div><a href="vimindex.html">Commands index</a></div>
      <div><a href="quickref.html">Quick reference</a></div>
      <hr/>
  <div class="help-toc-h1"><a href="#_introduction">Introduction</a>
<div class="help-toc-h2"><a href="#_some-words-on-the-api">Some words on the API</a></div>
</div><div class="help-toc-h1"><a href="#_using-lua">Using Lua</a>
<div class="help-toc-h2"><a href="#_using-lua-files-on-startup">Using Lua files on startup</a></div>
<div class="help-toc-h2"><a href="#_lua-modules">Lua modules</a></div>
<div class="help-toc-h2"><a href="#_see-also:">See also:</a></div>
</div><div class="help-toc-h1"><a href="#_using-vim-commands-and-functions-from-lua">Using Vim commands and functions from Lua</a>
<div class="help-toc-h2"><a href="#_vim-commands">Vim commands</a></div>
<div class="help-toc-h2"><a href="#_vimscript-functions">Vimscript functions</a></div>
<div class="help-toc-h2"><a href="#_see-also:">See also:</a></div>
</div><div class="help-toc-h1"><a href="#_variables">Variables</a>
<div class="help-toc-h2"><a href="#_see-also:">See also:</a></div>
</div><div class="help-toc-h1"><a href="#_options">Options</a>
<div class="help-toc-h2"><a href="#_vim.opt">vim.opt</a></div>
<div class="help-toc-h2"><a href="#_vim.o">vim.o</a></div>
<div class="help-toc-h2"><a href="#_see-also:">See also:</a></div>
</div><div class="help-toc-h1"><a href="#_mappings">Mappings</a>
<div class="help-toc-h2"><a href="#_creating-mappings">Creating mappings</a></div>
<div class="help-toc-h2"><a href="#_removing-mappings">Removing mappings</a></div>
<div class="help-toc-h2"><a href="#_see-also:">See also:</a></div>
</div><div class="help-toc-h1"><a href="#_autocommands">Autocommands</a>
<div class="help-toc-h2"><a href="#_creating-autocommands">Creating autocommands</a></div>
<div class="help-toc-h2"><a href="#_grouping-autocommands">Grouping autocommands</a></div>
<div class="help-toc-h2"><a href="#_deleting-autocommands">Deleting autocommands</a></div>
<div class="help-toc-h2"><a href="#_see-also">See also</a></div>
</div><div class="help-toc-h1"><a href="#_user-commands">User commands</a>
<div class="help-toc-h2"><a href="#_creating-user-commands">Creating user commands</a></div>
<div class="help-toc-h2"><a href="#_deleting-user-commands">Deleting user commands</a></div>
</div><div class="help-toc-h1"><a href="#_credits">Credits</a>
</div></div>
</div>
  <footer>
    <div class="container flex">
      <div class="generator-stats">
        Generated at 2026-01-20 05:33 from <code><a href="https://github.com/neovim/neovim/commit/0712a9c87bfe1ce08ae95a0cb30e5857c28e861c">0712a9c</a></code>
      </div>
      <div class="generator-stats">
      parse_errors: 0 (<a href="https://github.com/neovim/neovim/issues/new?labels=bug&title=user+docs+HTML%3A+lua-guide.txt+&body=%60gen_help_html.lua%60+problem+at%3A+https://neovim.io/doc/user/lua-guide.html%0D%0DContext%3A%0D%0D%60%60%60%0DTODO%0D%60%60%60" target="_blank">report docs bug...</a>) | <span title="                        Nvim
                            NVIM REFERENCE MANUAL
                                       Type &lt;a href="various.html#gO"&gt;gO&lt;/a&gt; to see the table of contents.">noise_lines: 3</span>
      </div>
    <div>

    <!-- algolia docsearch https://docsearch.algolia.com/docs/docsearch-v3/ -->
    <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
    <script type="module">
      docsearch({
        container: '#docsearch',
        appId: 'X185E15FPG',
        apiKey: 'b5e6b2f9c636b2b471303205e59832ed',
        indexName: 'nvim',
      });
    </script>

  </footer>
  </body>
</html>
