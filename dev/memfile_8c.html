<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>Neovim: src/nvim/memfile.c File Reference</title>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="extra.css" rel="stylesheet" type="text/css"/>
<link href="http://fonts.googleapis.com/css?family=Lato:400,700,900" rel="stylesheet">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<header class="navbar">
  <div class="container">
    <nav class="site-nav">
      <ul>
        <li><a href="http://neovim.io/">Neovim Home</a></li>
      </ul>
    </nav>
    <a href="index.html">
      <img src="logo-devdoc.png" class="logo" alt="Neovim Dev-Doc">
    </a>
  </div>
</header>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_bc030da22f6f77ebb27ffd39b609bafa.html">nvim</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">memfile.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="assert_8h_source.html">assert.h</a>&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;inttypes.h&gt;</code><br />
<code>#include &lt;limits.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &quot;<a class="el" href="vim_8h_source.html">nvim/vim.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ascii_8h_source.html">nvim/ascii.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="memfile_8h_source.html">nvim/memfile.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fileio_8h_source.html">nvim/fileio.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="memline_8h_source.html">nvim/memline.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="message_8h_source.html">nvim/message.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="misc2_8h_source.html">nvim/misc2.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="memory_8h_source.html">nvim/memory.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="os__unix_8h_source.html">nvim/os_unix.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="path_8h_source.html">nvim/path.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="os_8h_source.html">nvim/os/os.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="input_8h_source.html">nvim/os/input.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:af33c5d4aa5fc758b187d99e9294b0937"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#af33c5d4aa5fc758b187d99e9294b0937">MEMFILE_PAGE_SIZE</a>&#160;&#160;&#160;4096</td></tr>
<tr class="separator:af33c5d4aa5fc758b187d99e9294b0937"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bf2e78467751df711fd24a951a26c6f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#a2bf2e78467751df711fd24a951a26c6f">MHT_LOG_LOAD_FACTOR</a>&#160;&#160;&#160;6</td></tr>
<tr class="separator:a2bf2e78467751df711fd24a951a26c6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74205ecd6af4f50f3ff5568adc00821a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#a74205ecd6af4f50f3ff5568adc00821a">MHT_GROWTH_FACTOR</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a74205ecd6af4f50f3ff5568adc00821a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6e68cf5ad6fb3085488b37df8dc37058"><td class="memItemLeft" align="right" valign="top"><a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#a6e68cf5ad6fb3085488b37df8dc37058">mf_open</a> (<a class="el" href="types_8h.html#abdb7824437f4665a51798757139f570b">char_u</a> *fname, int flags)</td></tr>
<tr class="memdesc:a6e68cf5ad6fb3085488b37df8dc37058"><td class="mdescLeft">&#160;</td><td class="mdescRight">total memory used for memfiles  <a href="#a6e68cf5ad6fb3085488b37df8dc37058">More...</a><br /></td></tr>
<tr class="separator:a6e68cf5ad6fb3085488b37df8dc37058"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f855db0909de20a82fcd3ed904cfe37"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#a6f855db0909de20a82fcd3ed904cfe37">mf_open_file</a> (<a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *mfp, <a class="el" href="types_8h.html#abdb7824437f4665a51798757139f570b">char_u</a> *fname)</td></tr>
<tr class="separator:a6f855db0909de20a82fcd3ed904cfe37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef4453d413bf4d505fb0b0c8d9a1e091"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#aef4453d413bf4d505fb0b0c8d9a1e091">mf_close</a> (<a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *mfp, bool del_file)</td></tr>
<tr class="separator:aef4453d413bf4d505fb0b0c8d9a1e091"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba3d639cb609e6cfcc3781814e472fe3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#aba3d639cb609e6cfcc3781814e472fe3">mf_close_file</a> (<a class="el" href="buffer__defs_8h.html#aa01338a8366285f2e0afc18a70f7614f">buf_T</a> *buf, bool getlines)</td></tr>
<tr class="separator:aba3d639cb609e6cfcc3781814e472fe3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b30ac8793ff0a0c43cc82527eb9d3c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#a4b30ac8793ff0a0c43cc82527eb9d3c7">mf_new_page_size</a> (<a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *mfp, unsigned new_size)</td></tr>
<tr class="separator:a4b30ac8793ff0a0c43cc82527eb9d3c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b1b4262c5822a82e9969cf8ddc8a358"><td class="memItemLeft" align="right" valign="top"><a class="el" href="memfile__defs_8h.html#a07d6289e2ce31a0f27a6d7158699d153">bhdr_T</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#a7b1b4262c5822a82e9969cf8ddc8a358">mf_new</a> (<a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *mfp, bool negative, unsigned page_count)</td></tr>
<tr class="separator:a7b1b4262c5822a82e9969cf8ddc8a358"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e528dbb4e90f4b48dc82c5dc0b529a9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="memfile__defs_8h.html#a07d6289e2ce31a0f27a6d7158699d153">bhdr_T</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#a2e528dbb4e90f4b48dc82c5dc0b529a9">mf_get</a> (<a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *mfp, <a class="el" href="memfile__defs_8h.html#a533663bf2130c33647183f293b1c83e9">blocknr_T</a> nr, unsigned page_count)</td></tr>
<tr class="separator:a2e528dbb4e90f4b48dc82c5dc0b529a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8830d20124be099c3d02e52fb15074e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#a8830d20124be099c3d02e52fb15074e0">mf_put</a> (<a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *mfp, <a class="el" href="memfile__defs_8h.html#a07d6289e2ce31a0f27a6d7158699d153">bhdr_T</a> *hp, bool dirty, bool infile)</td></tr>
<tr class="separator:a8830d20124be099c3d02e52fb15074e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69265c5b601f69e279b2bad593613e18"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#a69265c5b601f69e279b2bad593613e18">mf_free</a> (<a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *mfp, <a class="el" href="memfile__defs_8h.html#a07d6289e2ce31a0f27a6d7158699d153">bhdr_T</a> *hp)</td></tr>
<tr class="memdesc:a69265c5b601f69e279b2bad593613e18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Signal block as no longer used (may put it in the free list).  <a href="#a69265c5b601f69e279b2bad593613e18">More...</a><br /></td></tr>
<tr class="separator:a69265c5b601f69e279b2bad593613e18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a2aa007c9974950d936bcb9d739563a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#a0a2aa007c9974950d936bcb9d739563a">mf_sync</a> (<a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *mfp, int flags)</td></tr>
<tr class="separator:a0a2aa007c9974950d936bcb9d739563a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabb7739af88ce85526b63f333e10bed6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#aabb7739af88ce85526b63f333e10bed6">mf_set_dirty</a> (<a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *mfp)</td></tr>
<tr class="separator:aabb7739af88ce85526b63f333e10bed6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6013f183ba97c134dc7c156eeeafec6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#aa6013f183ba97c134dc7c156eeeafec6">mf_release_all</a> (void)</td></tr>
<tr class="separator:aa6013f183ba97c134dc7c156eeeafec6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac224c12ac428b0a19a3b38ecd98310a3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="memfile__defs_8h.html#a533663bf2130c33647183f293b1c83e9">blocknr_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#ac224c12ac428b0a19a3b38ecd98310a3">mf_trans_del</a> (<a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *mfp, <a class="el" href="memfile__defs_8h.html#a533663bf2130c33647183f293b1c83e9">blocknr_T</a> old_nr)</td></tr>
<tr class="separator:ac224c12ac428b0a19a3b38ecd98310a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d08b5a784a38d87c1338f37ffee917a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#a0d08b5a784a38d87c1338f37ffee917a">mf_set_ffname</a> (<a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *mfp)</td></tr>
<tr class="separator:a0d08b5a784a38d87c1338f37ffee917a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac165bbbf9ce06b4a7bb612d280de6c3a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#ac165bbbf9ce06b4a7bb612d280de6c3a">mf_fullname</a> (<a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *mfp)</td></tr>
<tr class="separator:ac165bbbf9ce06b4a7bb612d280de6c3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a7c440dd307faba3a16cfc98315c77e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memfile_8c.html#a8a7c440dd307faba3a16cfc98315c77e">mf_need_trans</a> (<a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *mfp)</td></tr>
<tr class="memdesc:a8a7c440dd307faba3a16cfc98315c77e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return TRUE if there are any translations pending for memfile.  <a href="#a8a7c440dd307faba3a16cfc98315c77e">More...</a><br /></td></tr>
<tr class="separator:a8a7c440dd307faba3a16cfc98315c77e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="af33c5d4aa5fc758b187d99e9294b0937"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MEMFILE_PAGE_SIZE&#160;&#160;&#160;4096</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>An abstraction to handle blocks of memory which can be stored in a file. This is the implementation of a sort of virtual memory.</p>
<p>A memfile consists of a sequence of blocks:</p><ul>
<li>Blocks numbered from 0 upwards have been assigned a place in the actual file. The block number is equal to the page number in the file.</li>
<li>Blocks with negative numbers are currently in memory only. They can be assigned a place in the file when too much memory is being used. At that moment, they get a new, positive, number. A list is used for translation of negative to positive numbers.</li>
</ul>
<p>The size of a block is a multiple of a page size, normally the page size of the device the file is on. Most blocks are 1 page long. A block of multiple pages is used for a line that does not fit in a single page.</p>
<p>Each block can be in memory and/or in a file. The block stays in memory as long as it is locked. If it is no longer locked it can be swapped out to the file. It is only written to the file if it has been changed.</p>
<p>Under normal operation the file is created when opening the memory file and deleted when closing the memory file. Only with recovery an existing memory file is opened.</p>
<p>The functions for using a memfile:</p>
<p><a class="el" href="memfile_8c.html#a6e68cf5ad6fb3085488b37df8dc37058" title="total memory used for memfiles ">mf_open()</a> open a new or existing memfile <a class="el" href="memfile_8c.html#a6f855db0909de20a82fcd3ed904cfe37">mf_open_file()</a> open a swap file for an existing memfile <a class="el" href="memfile_8c.html#aef4453d413bf4d505fb0b0c8d9a1e091">mf_close()</a> close (and delete) a memfile <a class="el" href="memfile_8c.html#a7b1b4262c5822a82e9969cf8ddc8a358">mf_new()</a> create a new block in a memfile and lock it <a class="el" href="memfile_8c.html#a2e528dbb4e90f4b48dc82c5dc0b529a9">mf_get()</a> get an existing block and lock it <a class="el" href="memfile_8c.html#a8830d20124be099c3d02e52fb15074e0">mf_put()</a> unlock a block, may be marked for writing <a class="el" href="memfile_8c.html#a69265c5b601f69e279b2bad593613e18" title="Signal block as no longer used (may put it in the free list). ">mf_free()</a> remove a block <a class="el" href="memfile_8c.html#a0a2aa007c9974950d936bcb9d739563a">mf_sync()</a> sync changed parts of memfile to disk <a class="el" href="memfile_8c.html#aa6013f183ba97c134dc7c156eeeafec6">mf_release_all()</a> release as much memory as possible <a class="el" href="memfile_8c.html#ac224c12ac428b0a19a3b38ecd98310a3">mf_trans_del()</a> may translate negative to positive block number <a class="el" href="memfile_8c.html#ac165bbbf9ce06b4a7bb612d280de6c3a">mf_fullname()</a> make file name full path (use before first :cd) </p>

</div>
</div>
<a class="anchor" id="a74205ecd6af4f50f3ff5568adc00821a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MHT_GROWTH_FACTOR&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a2bf2e78467751df711fd24a951a26c6f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MHT_LOG_LOAD_FACTOR&#160;&#160;&#160;6</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The number of buckets in the hashtable is increased by a factor of MHT_GROWTH_FACTOR when the average number of items per bucket exceeds 2 ^ MHT_LOG_LOAD_FACTOR. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aef4453d413bf4d505fb0b0c8d9a1e091"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mf_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *&#160;</td>
          <td class="paramname"><em>mfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>del_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Close a memory file and optionally delete the associated file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">del_file</td><td>Whether to delete associated file. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aba3d639cb609e6cfcc3781814e472fe3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mf_close_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="buffer__defs_8h.html#aa01338a8366285f2e0afc18a70f7614f">buf_T</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>getlines</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Close the swap file for a memfile. Used when 'swapfile' is reset.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">getlines</td><td>Whether to get all lines into memory. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a69265c5b601f69e279b2bad593613e18"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mf_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *&#160;</td>
          <td class="paramname"><em>mfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="memfile__defs_8h.html#a07d6289e2ce31a0f27a6d7158699d153">bhdr_T</a> *&#160;</td>
          <td class="paramname"><em>hp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Signal block as no longer used (may put it in the free list). </p>

</div>
</div>
<a class="anchor" id="ac165bbbf9ce06b4a7bb612d280de6c3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mf_fullname </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *&#160;</td>
          <td class="paramname"><em>mfp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make name of memfile's swapfile a full path.</p>
<p>Used before doing a :cd </p>

</div>
</div>
<a class="anchor" id="a2e528dbb4e90f4b48dc82c5dc0b529a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="memfile__defs_8h.html#a07d6289e2ce31a0f27a6d7158699d153">bhdr_T</a>* mf_get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *&#160;</td>
          <td class="paramname"><em>mfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="memfile__defs_8h.html#a533663bf2130c33647183f293b1c83e9">blocknr_T</a>&#160;</td>
          <td class="paramname"><em>nr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>page_count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a8a7c440dd307faba3a16cfc98315c77e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mf_need_trans </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *&#160;</td>
          <td class="paramname"><em>mfp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return TRUE if there are any translations pending for memfile. </p>

</div>
</div>
<a class="anchor" id="a7b1b4262c5822a82e9969cf8ddc8a358"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="memfile__defs_8h.html#a07d6289e2ce31a0f27a6d7158699d153">bhdr_T</a>* mf_new </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *&#160;</td>
          <td class="paramname"><em>mfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>negative</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>page_count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a new block</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">negative</td><td>Whether a negative block number is desired (data block). </td></tr>
    <tr><td class="paramname">page_count</td><td>Desired number of pages. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4b30ac8793ff0a0c43cc82527eb9d3c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mf_new_page_size </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *&#160;</td>
          <td class="paramname"><em>mfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>new_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set new size for a memfile. Used when block 0 of a swapfile has been read and the size it indicates differs from what was guessed. </p>

</div>
</div>
<a class="anchor" id="a6e68cf5ad6fb3085488b37df8dc37058"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a>* mf_open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#abdb7824437f4665a51798757139f570b">char_u</a> *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>total memory used for memfiles </p>
<p>Open a new or existing memory block file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname</td><td>Name of file to use.<ul>
<li>If NULL, it means no file (use memory only).</li>
<li>If not NULL:<ul>
<li>Should correspond to an existing file.</li>
<li><a class="el" href="structString.html">String</a> must have been allocated (it is not copied).</li>
<li>If opening the file fails, it is freed and function fails. </li>
</ul>
</li>
</ul>
</td></tr>
    <tr><td class="paramname">flags</td><td>Flags for open() call.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- The open memory file, on success.<ul>
<li>NULL, on failure. </li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="a6f855db0909de20a82fcd3ed904cfe37"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mf_open_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *&#160;</td>
          <td class="paramname"><em>mfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#abdb7824437f4665a51798757139f570b">char_u</a> *&#160;</td>
          <td class="paramname"><em>fname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Open a file for an existing memfile.</p>
<p>Used when updatecount set from 0 to some value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname</td><td>Name of file to use.<ul>
<li>If NULL, it means no file (use memory only).</li>
<li>If not NULL:<ul>
<li>Should correspond to an existing file.</li>
<li><a class="el" href="structString.html">String</a> must have been allocated (it is not copied).</li>
<li>If opening the file fails, it is freed and function fails.</li>
</ul>
</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>OK On success. FAIL If file could not be opened. </dd></dl>

</div>
</div>
<a class="anchor" id="a8830d20124be099c3d02e52fb15074e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mf_put </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *&#160;</td>
          <td class="paramname"><em>mfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="memfile__defs_8h.html#a07d6289e2ce31a0f27a6d7158699d153">bhdr_T</a> *&#160;</td>
          <td class="paramname"><em>hp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>dirty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>infile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release the block *hp.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dirty</td><td>Whether block must be written to file later. </td></tr>
    <tr><td class="paramname">infile</td><td>Whether block should be in file (needed for recovery). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa6013f183ba97c134dc7c156eeeafec6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mf_release_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release as many blocks as possible.</p>
<p>Used in case of out of memory</p>
<dl class="section return"><dt>Returns</dt><dd>Whether any memory was released. </dd></dl>

</div>
</div>
<a class="anchor" id="aabb7739af88ce85526b63f333e10bed6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mf_set_dirty </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *&#160;</td>
          <td class="paramname"><em>mfp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set dirty flag for all blocks in memory file with a positive block number. These are blocks that need to be written to a newly created swapfile. </p>

</div>
</div>
<a class="anchor" id="a0d08b5a784a38d87c1338f37ffee917a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mf_set_ffname </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *&#160;</td>
          <td class="paramname"><em>mfp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set full file name of memfile's swapfile, out of simple file name and some other considerations.</p>
<p>Only called when creating or renaming the swapfile. Either way it's a new name so we must work out the full path name. </p>

</div>
</div>
<a class="anchor" id="a0a2aa007c9974950d936bcb9d739563a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mf_sync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *&#160;</td>
          <td class="paramname"><em>mfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sync memory file to disk.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flags</td><td>MFS_ALL If not given, blocks with negative numbers are not synced, even when they are dirty. MFS_STOP Stop syncing when a character becomes available, but sync at least one block. MFS_FLUSH Make sure buffers are flushed to disk, so they will survive a system crash. MFS_ZERO Only write block 0.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>FAIL If failure. Possible causes:<ul>
<li>No file (nothing to do).</li>
<li>Write error (probably full disk). OK Otherwise. </li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="ac224c12ac428b0a19a3b38ecd98310a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="memfile__defs_8h.html#a533663bf2130c33647183f293b1c83e9">blocknr_T</a> mf_trans_del </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfile__defs_8h.html#ad61e1be8425648048c84fa64af7a359d">memfile_T</a> *&#160;</td>
          <td class="paramname"><em>mfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="memfile__defs_8h.html#a533663bf2130c33647183f293b1c83e9">blocknr_T</a>&#160;</td>
          <td class="paramname"><em>old_nr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Lookup translation from trans list and delete the entry.</p>
<dl class="section return"><dt>Returns</dt><dd>The positive new number When found. The old number When not found. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<footer>
  <div class="container">
    Generated on Fri Jul 31 2015 08:16:06 for Neovim by
    <a href="http://www.doxygen.org/index.html">Doxygen</a>
    1.8.7
  </div>
</footer>
</body>
</html>
